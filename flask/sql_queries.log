2025-06-14 13:36:30,494 - INFO - Client disconnected from WebSocket
2025-06-14 13:37:37,929 - INFO - Client disconnected from WebSocket
2025-06-14 13:38:03,227 - INFO - Client disconnected from WebSocket
2025-06-14 13:38:48,472 - INFO - Client disconnected from WebSocket
2025-06-14 13:38:55,140 - INFO - Client disconnected from WebSocket
2025-06-14 13:39:01,043 - INFO - Client disconnected from WebSocket
2025-06-14 13:39:05,456 - INFO - chat_id_enc 825f4db9-4375-4ea5-a587-d2e2039f928d
2025-06-14 13:39:05,456 - INFO - Executing chat history query for chat_id 825f4db9-4375-4ea5-a587-d2e2039f928d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:39:05,457 - INFO - Saving message to DB for chat_id 825f4db9-4375-4ea5-a587-d2e2039f928d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:39:05,462 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:39:05,464 - INFO - Processing query for user_id 1: hi
2025-06-14 13:39:05,465 - INFO - Generated unique_id_with_template: uid_9397487a31f54c7dbb9cbd592a730d65
2025-06-14 13:39:05,887 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:39:05,914 - INFO - Intent classification: chat
2025-06-14 13:39:05,914 - INFO - Final prompt created with unique_id_with_template: uid_9397487a31f54c7dbb9cbd592a730d65
2025-06-14 13:39:06,634 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:39:21,455 - INFO - chat_id_enc 
2025-06-14 13:39:21,768 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:39:22,277 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:39:22,534 - INFO - Created new chat with ID 7 and UUID ec872335-c839-4f0c-93a1-50d0fdaac9f2 for user 1
2025-06-14 13:39:22,534 - INFO - 7
2025-06-14 13:39:22,535 - INFO - Executing chat history query for chat_id 7:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:39:22,536 - INFO - Saving message to DB for chat_id 7, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:39:22,540 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:39:22,541 - INFO - Processing query for user_id 1: cool
2025-06-14 13:39:22,541 - INFO - Generated unique_id_with_template: uid_3f04f1eb05f04c3eb4d596868c178518
2025-06-14 13:39:22,874 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:39:22,933 - INFO - Intent classification: chat
2025-06-14 13:39:22,933 - INFO - Final prompt created with unique_id_with_template: uid_3f04f1eb05f04c3eb4d596868c178518
2025-06-14 13:39:23,298 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:44:47,586 - INFO - Client disconnected from WebSocket
2025-06-14 13:44:58,614 - INFO - chat_id_enc 
2025-06-14 13:44:59,123 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:45:00,316 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:45:00,604 - INFO - Created new chat with ID 8 and UUID 51a511ae-7cd7-4994-88c2-7733467f298c for user 1
2025-06-14 13:45:00,605 - INFO - 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:45:00,605 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:45:00,606 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:45:00,612 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:45:00,613 - INFO - Processing query for user_id 1: supp
2025-06-14 13:45:00,613 - INFO - Generated unique_id_with_template: uid_f4dd534961da43cf925eaddb31031e65
2025-06-14 13:45:00,941 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:45:00,984 - INFO - Intent classification: chat
2025-06-14 13:45:00,984 - INFO - Final prompt created with unique_id_with_template: uid_f4dd534961da43cf925eaddb31031e65
2025-06-14 13:45:01,322 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:45:32,858 - INFO - Client disconnected from WebSocket
2025-06-14 13:46:19,084 - INFO - Client disconnected from WebSocket
2025-06-14 13:46:44,393 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:46:44,393 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:46:44,394 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:46:44,398 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:46:44,399 - INFO - Processing query for user_id 1: nice tell me about ayo
2025-06-14 13:46:44,400 - INFO - Generated unique_id_with_template: uid_623bffea379740b09338f4232ffe67e4
2025-06-14 13:46:44,753 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:46:44,797 - INFO - Intent classification: chat
2025-06-14 13:46:44,797 - INFO - Final prompt created with unique_id_with_template: uid_623bffea379740b09338f4232ffe67e4
2025-06-14 13:46:45,119 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:46:51,872 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:46:51,873 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:46:51,874 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:46:51,878 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:46:51,879 - INFO - Processing query for user_id 1: did u check?
2025-06-14 13:46:51,879 - INFO - Generated unique_id_with_template: uid_3783591df32f458f856e46bf5a771ec0
2025-06-14 13:46:52,185 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:46:52,281 - INFO - Intent classification: chat
2025-06-14 13:46:52,282 - INFO - Final prompt created with unique_id_with_template: uid_3783591df32f458f856e46bf5a771ec0
2025-06-14 13:46:52,578 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:03,893 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:47:03,893 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:47:03,894 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:47:03,897 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:47:03,898 - INFO - Processing query for user_id 1: did you check yes or no
2025-06-14 13:47:03,898 - INFO - Generated unique_id_with_template: uid_b5189688ae1845a7b2968babffb6ef93
2025-06-14 13:47:04,224 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:04,263 - INFO - Intent classification: chat
2025-06-14 13:47:04,264 - INFO - Final prompt created with unique_id_with_template: uid_b5189688ae1845a7b2968babffb6ef93
2025-06-14 13:47:04,842 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:09,682 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:47:09,682 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:47:09,684 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:47:09,688 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:47:09,689 - INFO - Processing query for user_id 1: check again
2025-06-14 13:47:09,690 - INFO - Generated unique_id_with_template: uid_fe8b059cbb5747efaa9d6325c446544c
2025-06-14 13:47:09,965 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:09,999 - INFO - Intent classification: chat
2025-06-14 13:47:09,999 - INFO - Final prompt created with unique_id_with_template: uid_fe8b059cbb5747efaa9d6325c446544c
2025-06-14 13:47:10,295 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:16,340 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:47:16,340 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:47:16,341 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:47:16,344 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:47:16,345 - INFO - Processing query for user_id 1: what about allphonesblog ng
2025-06-14 13:47:16,345 - INFO - Generated unique_id_with_template: uid_63245c4b0b0e493aa76e8c70bfee5c74
2025-06-14 13:47:16,725 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:16,785 - INFO - Intent classification: chat
2025-06-14 13:47:16,785 - INFO - Final prompt created with unique_id_with_template: uid_63245c4b0b0e493aa76e8c70bfee5c74
2025-06-14 13:47:19,907 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:26,920 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:47:26,920 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:47:26,921 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:47:26,924 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:47:26,925 - INFO - Processing query for user_id 1: what about all tasks
2025-06-14 13:47:26,925 - INFO - Generated unique_id_with_template: uid_95cc15369d9e43a886f307a2a5c231be
2025-06-14 13:47:27,469 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:27,507 - INFO - Intent classification: sql
2025-06-14 13:47:27,523 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 13:47:28,069 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:47:30,636 - INFO - Generated SQL Query for user_id 1:
SELECT tasks.id,
       tasks.title,
       tasks.description,
       tasks.status,
       tasks.priority,
       tasks.estimate,
       tasks.due_date,
       tasks.created_at,
       tasks.updated_at,
       platform_users.full_name AS user_name,
       teams.name AS team_name,
       projects.name AS project_name
FROM tasks
LEFT JOIN platform_users ON tasks.user_id = platform_users.user_id
AND tasks.owner_id = platform_users.owner_id
LEFT JOIN teams ON tasks.team_id = teams.platform_id
AND tasks.owner_id = teams.owner_id
LEFT JOIN projects ON tasks.project_id IS NULL
AND tasks.owner_id = projects.owner_id
WHERE tasks.owner_id = 1;
2025-06-14 13:47:30,641 - INFO - Raw DB data retrieved: 121 rows
2025-06-14 13:47:30,641 - INFO - Sample data: {'id': 1, 'title': 'Linear API Integration', 'description': None, 'status': 'In Progress', 'priority': 2, 'estimate': 3.3402, 'due_date': '2025-06-09 00:00:00', 'created_at': datetime.datetime(2025, 6, 2, 23, 7, 25), 'updated_at': datetime.datetime(2025, 6, 2, 23, 7, 25), 'user_name': 'allphonesblog ng', 'team_name': None, 'project_name': 'User Interface'}
2025-06-14 13:47:30,643 - INFO - Final prompt created with unique_id_with_template: uid_95cc15369d9e43a886f307a2a5c231be
2025-06-14 13:47:31,479 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:48:32,985 - INFO - Client disconnected from WebSocket
2025-06-14 13:51:51,052 - INFO - Client disconnected from WebSocket
2025-06-14 13:51:57,202 - INFO - chat_id_enc 51a511ae-7cd7-4994-88c2-7733467f298c
2025-06-14 13:51:57,202 - INFO - Executing chat history query for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 13:51:57,204 - INFO - Saving message to DB for chat_id 51a511ae-7cd7-4994-88c2-7733467f298c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 13:51:57,207 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 13:51:57,207 - INFO - Processing query for user_id 1: more info
2025-06-14 13:51:57,208 - INFO - Generated unique_id_with_template: uid_96707713ed0e4c32aaa3da41bf68ba92
2025-06-14 13:51:57,831 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 13:51:57,864 - INFO - Intent classification: chat
2025-06-14 13:51:57,864 - INFO - Final prompt created with unique_id_with_template: uid_96707713ed0e4c32aaa3da41bf68ba92
2025-06-14 13:51:58,214 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:00:32,529 - INFO - Client disconnected from WebSocket
2025-06-14 14:01:31,870 - INFO - Client disconnected from WebSocket
2025-06-14 14:02:58,586 - INFO - Client disconnected from WebSocket
2025-06-14 14:03:03,260 - INFO - Client disconnected from WebSocket
2025-06-14 14:14:11,636 - INFO - Client disconnected from WebSocket
2025-06-14 14:14:18,582 - INFO - Client disconnected from WebSocket
2025-06-14 14:14:21,582 - INFO - Client disconnected from WebSocket
2025-06-14 14:14:28,985 - INFO - Client disconnected from WebSocket
2025-06-14 14:16:33,380 - INFO - Client disconnected from WebSocket
2025-06-14 14:19:17,756 - INFO - Client disconnected from WebSocket
2025-06-14 14:20:10,750 - INFO - Client disconnected from WebSocket
2025-06-14 14:21:07,671 - INFO - Client disconnected from WebSocket
2025-06-14 14:21:17,668 - INFO - Client disconnected from WebSocket
2025-06-14 14:21:30,259 - INFO - Client disconnected from WebSocket
2025-06-14 14:21:51,400 - INFO - Client disconnected from WebSocket
2025-06-14 14:22:35,388 - INFO - Client disconnected from WebSocket
2025-06-14 14:22:56,930 - INFO - Client disconnected from WebSocket
2025-06-14 14:23:13,895 - INFO - Client disconnected from WebSocket
2025-06-14 14:23:42,349 - INFO - Client disconnected from WebSocket
2025-06-14 14:23:46,696 - INFO - Client disconnected from WebSocket
2025-06-14 14:25:20,456 - INFO - Client disconnected from WebSocket
2025-06-14 14:25:25,435 - INFO - Client disconnected from WebSocket
2025-06-14 14:26:17,655 - INFO - Client disconnected from WebSocket
2025-06-14 14:27:06,395 - INFO - Client disconnected from WebSocket
2025-06-14 14:27:11,732 - INFO - Client disconnected from WebSocket
2025-06-14 14:27:23,549 - INFO - Client disconnected from WebSocket
2025-06-14 14:27:45,866 - INFO - Client disconnected from WebSocket
2025-06-14 14:28:15,859 - INFO - Client disconnected from WebSocket
2025-06-14 14:29:10,013 - INFO - Client disconnected from WebSocket
2025-06-14 14:29:17,155 - INFO - Client disconnected from WebSocket
2025-06-14 14:29:50,404 - INFO - Client disconnected from WebSocket
2025-06-14 14:31:04,330 - INFO - Client disconnected from WebSocket
2025-06-14 14:31:08,650 - INFO - Client disconnected from WebSocket
2025-06-14 14:31:15,925 - INFO - Client disconnected from WebSocket
2025-06-14 14:31:45,568 - INFO - Client disconnected from WebSocket
2025-06-14 14:31:54,845 - INFO - Client disconnected from WebSocket
2025-06-14 14:32:48,154 - INFO - Client disconnected from WebSocket
2025-06-14 14:33:16,373 - INFO - Client disconnected from WebSocket
2025-06-14 14:33:33,201 - INFO - Client disconnected from WebSocket
2025-06-14 14:34:20,339 - INFO - Client disconnected from WebSocket
2025-06-14 14:35:21,044 - INFO - Client disconnected from WebSocket
2025-06-14 14:35:27,642 - INFO - chat_id_enc 
2025-06-14 14:35:28,103 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:28,782 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:28,964 - INFO - Created new chat with ID 1 and UUID 0202c6a7-7361-4b65-83a4-125a5cb08294 for user 1
2025-06-14 14:35:28,964 - INFO - 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:35:28,964 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:35:28,966 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:35:28,971 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:35:28,971 - INFO - Processing query for user_id 1: hey
2025-06-14 14:35:28,971 - INFO - Generated unique_id_with_template: uid_35b56dcc347c4a18b5c7166615ee99da
2025-06-14 14:35:29,406 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:29,461 - INFO - Intent classification: chat
2025-06-14 14:35:29,462 - INFO - Final prompt created with unique_id_with_template: uid_35b56dcc347c4a18b5c7166615ee99da
2025-06-14 14:35:29,988 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:35,794 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:35:35,794 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:35:35,795 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:35:35,798 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:35:35,799 - INFO - Processing query for user_id 1: m good wbu
2025-06-14 14:35:35,799 - INFO - Generated unique_id_with_template: uid_bd691a0a988248dcb56c714fa8ff50a7
2025-06-14 14:35:36,247 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:36,280 - INFO - Intent classification: chat
2025-06-14 14:35:36,280 - INFO - Final prompt created with unique_id_with_template: uid_bd691a0a988248dcb56c714fa8ff50a7
2025-06-14 14:35:36,832 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:47,894 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:35:47,894 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:35:47,895 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:35:47,899 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:35:47,900 - INFO - Processing query for user_id 1: uhmm what is the current status of my staffs
2025-06-14 14:35:47,900 - INFO - Generated unique_id_with_template: uid_493f5c72e284427d867ae70274c62a09
2025-06-14 14:35:48,371 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:48,417 - INFO - Intent classification: sql
2025-06-14 14:35:48,436 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 14:35:48,990 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:35:49,669 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name AS user_name,
       t.title AS task_title,
       t.status AS task_status
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.owner_id = 1
2025-06-14 14:35:49,671 - INFO - Raw DB data retrieved: 80 rows
2025-06-14 14:35:49,672 - INFO - Sample data: {'user_name': 'prebad50@gmail.com', 'task_title': 'frontend stage', 'task_status': 'Todo'}
2025-06-14 14:35:49,673 - INFO - Final prompt created with unique_id_with_template: uid_493f5c72e284427d867ae70274c62a09
2025-06-14 14:35:50,069 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:45,054 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:36:45,054 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:36:45,055 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:36:45,059 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:36:45,060 - INFO - Processing query for user_id 1: nice , i see allphonesblog is doing the most work lol
2025-06-14 14:36:45,060 - INFO - Generated unique_id_with_template: uid_b84725a7ffda45938de20001180bbc91
2025-06-14 14:36:45,756 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:45,777 - INFO - Intent classification: sql
2025-06-14 14:36:45,789 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 14:36:46,107 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:47,511 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name AS user_name,
       t.title AS task_title,
       t.status AS task_status
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.owner_id = 1
  AND pu.full_name LIKE '%allphonesblog%'
2025-06-14 14:36:47,513 - INFO - Raw DB data retrieved: 60 rows
2025-06-14 14:36:47,513 - INFO - Sample data: {'user_name': 'allphonesblog ng', 'task_title': 'Linear API Integration', 'task_status': 'In Progress'}
2025-06-14 14:36:47,514 - INFO - Final prompt created with unique_id_with_template: uid_b84725a7ffda45938de20001180bbc91
2025-06-14 14:36:47,933 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:55,539 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:36:55,540 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:36:55,541 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:36:55,544 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:36:55,545 - INFO - Processing query for user_id 1: give more info on him
2025-06-14 14:36:55,546 - INFO - Generated unique_id_with_template: uid_1f98eb0137d34473a509fd3b0dceb0cf
2025-06-14 14:36:56,049 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:56,089 - INFO - Intent classification: sql
2025-06-14 14:36:56,098 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 14:36:56,476 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:36:57,878 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name AS user_name,
       t.title AS task_title,
       t.status AS task_status,
       t.priority,
       t.estimate,
       t.due_date,
       p.name AS project_name,
       tm.name AS team_name
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
LEFT JOIN projects p ON t.project_id = p.id
LEFT JOIN teams tm ON t.team_id = tm.team_key
WHERE pu.name LIKE '%allphonesblog%'
  AND t.owner_id = 1;
2025-06-14 14:36:57,881 - INFO - Raw DB data retrieved: 120 rows
2025-06-14 14:36:57,881 - INFO - Sample data: {'user_name': 'allphonesblog ng', 'task_title': 'Linear API Integration', 'task_status': 'In Progress', 'priority': 2, 'estimate': 3.3402, 'due_date': '2025-06-09 00:00:00', 'project_name': None, 'team_name': 'Engineering'}
2025-06-14 14:36:57,882 - INFO - Final prompt created with unique_id_with_template: uid_1f98eb0137d34473a509fd3b0dceb0cf
2025-06-14 14:36:58,433 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:12,554 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:37:12,554 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:37:12,556 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:37:12,560 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:37:12,561 - INFO - Processing query for user_id 1: also for ayo too
2025-06-14 14:37:12,562 - INFO - Generated unique_id_with_template: uid_7a444a0b4a7749c5911371252a78eead
2025-06-14 14:37:12,958 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:13,017 - INFO - Intent classification: sql
2025-06-14 14:37:13,031 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 14:37:13,653 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:14,873 - INFO - Generated SQL Query for user_id 1:
SELECT t.title AS task_title,
       t.status AS task_status,
       t.priority,
       t.estimate,
       t.due_date
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE pu.full_name LIKE '%dev.ayomide@gmail.com%'
  AND t.owner_id = 1
2025-06-14 14:37:14,874 - INFO - Raw DB data retrieved: 2 rows
2025-06-14 14:37:14,874 - INFO - Sample data: {'task_title': 'UI UX DESIGN', 'task_status': 'In Progress', 'priority': 0, 'estimate': -45.6598, 'due_date': '2025-04-21 00:00:00'}
2025-06-14 14:37:14,875 - INFO - Final prompt created with unique_id_with_template: uid_7a444a0b4a7749c5911371252a78eead
2025-06-14 14:37:15,234 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:51,302 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:37:51,302 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:37:51,304 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:37:51,311 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:37:51,312 - INFO - Processing query for user_id 1: nice one.. i want u to give me a long breakdown
2025-06-14 14:37:51,313 - INFO - Generated unique_id_with_template: uid_eb37e965806642648eb9b5ca6a5fb936
2025-06-14 14:37:52,345 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:52,369 - INFO - Intent classification: sql
2025-06-14 14:37:52,379 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 14:37:52,885 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:37:54,789 - INFO - Generated SQL Query for user_id 1:
SELECT t.title AS task_title,
       t.status AS task_status,
       t.priority,
       t.estimate,
       t.due_date,
       pu.full_name AS user_name,
       tm.name AS team_name,
       p.name AS project_name
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
JOIN teams tm ON t.team_id = tm.team_key
LEFT JOIN projects p ON t.project_id IS NULL
WHERE pu.owner_id = 1
  AND pu.full_name LIKE '%ayomide%'
2025-06-14 14:37:54,791 - INFO - Raw DB data retrieved: 4 rows
2025-06-14 14:37:54,792 - INFO - Sample data: {'task_title': 'UI UX DESIGN', 'task_status': 'In Progress', 'priority': 0, 'estimate': -45.6605, 'due_date': '2025-04-21 00:00:00', 'user_name': 'dev.ayomide@gmail.com', 'team_name': 'Engineering', 'project_name': None}
2025-06-14 14:37:54,792 - INFO - Final prompt created with unique_id_with_template: uid_eb37e965806642648eb9b5ca6a5fb936
2025-06-14 14:37:55,194 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:06,694 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:38:06,694 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:38:06,696 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:38:06,699 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:38:06,699 - INFO - Processing query for user_id 1: cool
2025-06-14 14:38:06,699 - INFO - Generated unique_id_with_template: uid_2f900deafdae49c1a50258abbf6bca5a
2025-06-14 14:38:07,085 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:07,120 - INFO - Intent classification: chat
2025-06-14 14:38:07,120 - INFO - Final prompt created with unique_id_with_template: uid_2f900deafdae49c1a50258abbf6bca5a
2025-06-14 14:38:07,513 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:12,545 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:38:12,545 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:38:12,546 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:38:12,551 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:38:12,552 - INFO - Processing query for user_id 1: good boy
2025-06-14 14:38:12,552 - INFO - Generated unique_id_with_template: uid_348ecb30441a469c846a0392e519f7be
2025-06-14 14:38:12,909 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:12,934 - INFO - Intent classification: chat
2025-06-14 14:38:12,934 - INFO - Final prompt created with unique_id_with_template: uid_348ecb30441a469c846a0392e519f7be
2025-06-14 14:38:13,401 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:34,088 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:38:34,088 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:38:34,089 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:38:34,095 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:38:34,096 - INFO - Processing query for user_id 1: more 
2025-06-14 14:38:34,096 - INFO - Generated unique_id_with_template: uid_cf43522a406d4e41a086cc1d938ed6e0
2025-06-14 14:38:34,513 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:34,541 - INFO - Intent classification: chat
2025-06-14 14:38:34,542 - INFO - Final prompt created with unique_id_with_template: uid_cf43522a406d4e41a086cc1d938ed6e0
2025-06-14 14:38:34,911 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:37,891 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:38:37,891 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:38:37,892 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:38:37,898 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:38:37,899 - INFO - Processing query for user_id 1: more info
2025-06-14 14:38:37,899 - INFO - Generated unique_id_with_template: uid_eab536400c1b4c8f8d24efde6654c558
2025-06-14 14:38:38,314 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:38,346 - INFO - Intent classification: chat
2025-06-14 14:38:38,346 - INFO - Final prompt created with unique_id_with_template: uid_eab536400c1b4c8f8d24efde6654c558
2025-06-14 14:38:38,717 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:49,882 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:38:49,882 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:38:49,883 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:38:49,887 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:38:49,888 - INFO - Processing query for user_id 1: more info
2025-06-14 14:38:49,888 - INFO - Generated unique_id_with_template: uid_9abfed4d7fe642bd81a174c2feff09a5
2025-06-14 14:38:50,261 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:38:50,285 - INFO - Intent classification: chat
2025-06-14 14:38:50,285 - INFO - Final prompt created with unique_id_with_template: uid_9abfed4d7fe642bd81a174c2feff09a5
2025-06-14 14:38:50,689 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:39:14,212 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:39:14,212 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:39:14,213 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:39:14,218 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:39:14,219 - INFO - Processing query for user_id 1: more more more
2025-06-14 14:39:14,220 - INFO - Generated unique_id_with_template: uid_4ec8f0298e5242b3ad3734aa0bc75349
2025-06-14 14:39:14,643 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:39:14,684 - INFO - Intent classification: chat
2025-06-14 14:39:14,684 - INFO - Final prompt created with unique_id_with_template: uid_4ec8f0298e5242b3ad3734aa0bc75349
2025-06-14 14:39:15,056 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:39:26,332 - INFO - chat_id_enc 0202c6a7-7361-4b65-83a4-125a5cb08294
2025-06-14 14:39:26,333 - INFO - Executing chat history query for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 14:39:26,334 - INFO - Saving message to DB for chat_id 0202c6a7-7361-4b65-83a4-125a5cb08294, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 14:39:26,337 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 14:39:26,338 - INFO - Processing query for user_id 1: good one
2025-06-14 14:39:26,338 - INFO - Generated unique_id_with_template: uid_5887305b1ace4987801c34085f835fb5
2025-06-14 14:39:26,753 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:39:26,782 - INFO - Intent classification: chat
2025-06-14 14:39:26,782 - INFO - Final prompt created with unique_id_with_template: uid_5887305b1ace4987801c34085f835fb5
2025-06-14 14:39:27,302 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 14:39:30,006 - INFO - Client disconnected from WebSocket
2025-06-14 14:41:12,666 - INFO - Client disconnected from WebSocket
2025-06-14 14:43:26,413 - INFO - Client disconnected from WebSocket
2025-06-14 14:44:03,820 - INFO - Client disconnected from WebSocket
2025-06-14 14:45:00,851 - INFO - Client disconnected from WebSocket
2025-06-14 14:45:40,349 - INFO - Client disconnected from WebSocket
2025-06-14 14:45:58,708 - INFO - Client disconnected from WebSocket
2025-06-14 14:48:03,435 - INFO - Client disconnected from WebSocket
2025-06-14 14:50:27,368 - INFO - Client disconnected from WebSocket
2025-06-14 14:51:49,079 - INFO - Client disconnected from WebSocket
2025-06-14 14:54:47,944 - INFO - Client disconnected from WebSocket
2025-06-14 14:55:08,344 - INFO - Client disconnected from WebSocket
2025-06-14 14:57:12,513 - INFO - Client disconnected from WebSocket
2025-06-14 14:58:45,039 - INFO - Client disconnected from WebSocket
2025-06-14 15:00:34,198 - INFO - Client disconnected from WebSocket
2025-06-14 15:01:21,835 - INFO - Client disconnected from WebSocket
2025-06-14 15:02:30,640 - INFO - Client disconnected from WebSocket
2025-06-14 15:04:59,708 - INFO - Client disconnected from WebSocket
2025-06-14 15:05:46,297 - INFO - Client disconnected from WebSocket
2025-06-14 15:07:44,132 - INFO - Client disconnected from WebSocket
2025-06-14 15:08:11,559 - INFO - Client disconnected from WebSocket
2025-06-14 15:08:46,470 - INFO - Client disconnected from WebSocket
2025-06-14 15:09:03,421 - INFO - Client disconnected from WebSocket
2025-06-14 15:11:14,692 - INFO - Client disconnected from WebSocket
2025-06-14 15:19:31,664 - INFO - Client disconnected from WebSocket
2025-06-14 15:21:34,981 - INFO - Client disconnected from WebSocket
2025-06-14 15:22:21,847 - INFO - Client disconnected from WebSocket
2025-06-14 15:22:27,124 - INFO - chat_id_enc 
2025-06-14 15:22:27,491 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:22:28,102 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:22:28,402 - INFO - Created new chat with ID 1 and UUID 823e33aa-64cc-445c-b84f-7367687207ab for user 1
2025-06-14 15:22:28,402 - INFO - 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:22:28,403 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:22:28,405 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:22:28,408 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:22:28,408 - INFO - Processing query for user_id 1: sup
2025-06-14 15:22:28,409 - INFO - Generated unique_id_with_template: uid_465b700a610a43d1a5d5be03e52881da
2025-06-14 15:22:28,871 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:22:28,898 - INFO - Intent classification: chat
2025-06-14 15:22:28,898 - INFO - Final prompt created with unique_id_with_template: uid_465b700a610a43d1a5d5be03e52881da
2025-06-14 15:22:29,342 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:22:38,605 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:22:38,606 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:22:38,607 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:22:38,612 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:22:38,613 - INFO - Processing query for user_id 1: m good
2025-06-14 15:22:38,613 - INFO - Generated unique_id_with_template: uid_3453fe4ef7454c63829ddbb04552efcc
2025-06-14 15:22:39,292 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:22:39,331 - INFO - Intent classification: chat
2025-06-14 15:22:39,331 - INFO - Final prompt created with unique_id_with_template: uid_3453fe4ef7454c63829ddbb04552efcc
2025-06-14 15:22:39,660 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:23:09,413 - INFO - Client disconnected from WebSocket
2025-06-14 15:23:37,507 - INFO - Client disconnected from WebSocket
2025-06-14 15:23:41,524 - INFO - Client disconnected from WebSocket
2025-06-14 15:23:47,354 - INFO - Client disconnected from WebSocket
2025-06-14 15:23:50,748 - INFO - Client disconnected from WebSocket
2025-06-14 15:25:30,161 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:15,204 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:26,726 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:29,336 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:38,191 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:46,368 - INFO - Client disconnected from WebSocket
2025-06-14 15:26:51,279 - INFO - Client disconnected from WebSocket
2025-06-14 15:27:20,630 - INFO - Client disconnected from WebSocket
2025-06-14 15:27:37,911 - INFO - Client disconnected from WebSocket
2025-06-14 15:27:47,924 - INFO - Client disconnected from WebSocket
2025-06-14 15:28:14,496 - INFO - Client disconnected from WebSocket
2025-06-14 15:28:36,264 - INFO - Client disconnected from WebSocket
2025-06-14 15:28:41,533 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:28:41,533 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:28:41,534 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:28:41,538 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:28:41,539 - INFO - Processing query for user_id 1: nice one
2025-06-14 15:28:41,539 - INFO - Generated unique_id_with_template: uid_e09f58a8281547cd9b6d2794e102a3bd
2025-06-14 15:28:41,993 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:28:42,055 - INFO - Intent classification: chat
2025-06-14 15:28:42,055 - INFO - Final prompt created with unique_id_with_template: uid_e09f58a8281547cd9b6d2794e102a3bd
2025-06-14 15:28:42,384 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:28:46,664 - INFO - Client disconnected from WebSocket
2025-06-14 15:28:59,910 - INFO - Client disconnected from WebSocket
2025-06-14 15:29:06,096 - INFO - Client disconnected from WebSocket
2025-06-14 15:29:12,096 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:29:12,096 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:29:12,097 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:29:12,101 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:29:12,102 - INFO - Processing query for user_id 1: cool
2025-06-14 15:29:12,102 - INFO - Generated unique_id_with_template: uid_9644bc5ff72d4da7bca294ae72c09846
2025-06-14 15:29:13,359 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:13,393 - INFO - Intent classification: chat
2025-06-14 15:29:13,393 - INFO - Final prompt created with unique_id_with_template: uid_9644bc5ff72d4da7bca294ae72c09846
2025-06-14 15:29:14,010 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:15,653 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:29:15,653 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:29:15,654 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:29:15,658 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:29:15,659 - INFO - Processing query for user_id 1: i
2025-06-14 15:29:15,660 - INFO - Generated unique_id_with_template: uid_b7c16335621d4b83a2b6b93de9e9a1f9
2025-06-14 15:29:16,444 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:16,484 - INFO - Intent classification: chat
2025-06-14 15:29:16,484 - INFO - Final prompt created with unique_id_with_template: uid_b7c16335621d4b83a2b6b93de9e9a1f9
2025-06-14 15:29:16,959 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:18,576 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:29:18,576 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:29:18,577 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:29:18,580 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:29:18,581 - INFO - Processing query for user_id 1: love
2025-06-14 15:29:18,581 - INFO - Generated unique_id_with_template: uid_c0613b7fdb044ad9b8cc113564b011b9
2025-06-14 15:29:19,008 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:19,047 - INFO - Intent classification: chat
2025-06-14 15:29:19,048 - INFO - Final prompt created with unique_id_with_template: uid_c0613b7fdb044ad9b8cc113564b011b9
2025-06-14 15:29:19,383 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:21,100 - INFO - chat_id_enc 823e33aa-64cc-445c-b84f-7367687207ab
2025-06-14 15:29:21,100 - INFO - Executing chat history query for chat_id 823e33aa-64cc-445c-b84f-7367687207ab:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 15:29:21,101 - INFO - Saving message to DB for chat_id 823e33aa-64cc-445c-b84f-7367687207ab, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 15:29:21,105 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 15:29:21,106 - INFO - Processing query for user_id 1: you
2025-06-14 15:29:21,106 - INFO - Generated unique_id_with_template: uid_4d3f18826a054fe28a3a5b55263a3267
2025-06-14 15:29:21,773 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:21,790 - INFO - Intent classification: chat
2025-06-14 15:29:21,790 - INFO - Final prompt created with unique_id_with_template: uid_4d3f18826a054fe28a3a5b55263a3267
2025-06-14 15:29:22,457 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 15:29:25,632 - INFO - Client disconnected from WebSocket
2025-06-14 15:31:24,106 - INFO - Client disconnected from WebSocket
2025-06-14 15:32:29,785 - INFO - Client disconnected from WebSocket
2025-06-14 15:33:10,133 - INFO - Client disconnected from WebSocket
2025-06-14 15:33:36,354 - INFO - Client disconnected from WebSocket
2025-06-14 15:34:23,400 - INFO - Client disconnected from WebSocket
2025-06-14 15:34:32,214 - INFO - Client disconnected from WebSocket
2025-06-14 15:34:42,182 - INFO - Client disconnected from WebSocket
2025-06-14 15:34:52,254 - INFO - Client disconnected from WebSocket
2025-06-14 15:35:10,813 - INFO - Client disconnected from WebSocket
2025-06-14 15:35:52,456 - INFO - Client disconnected from WebSocket
2025-06-14 15:36:44,230 - INFO - Client disconnected from WebSocket
2025-06-14 15:36:56,565 - INFO - Client disconnected from WebSocket
2025-06-14 15:37:23,119 - INFO - Client disconnected from WebSocket
2025-06-14 15:38:28,215 - INFO - Client disconnected from WebSocket
2025-06-14 15:38:37,504 - INFO - Client disconnected from WebSocket
2025-06-14 15:39:38,738 - INFO - Client disconnected from WebSocket
2025-06-14 16:21:58,508 - INFO - Client disconnected from WebSocket
2025-06-14 16:22:31,772 - INFO - Client disconnected from WebSocket
2025-06-14 16:23:05,111 - INFO - Client disconnected from WebSocket
2025-06-14 16:24:24,848 - INFO - Client disconnected from WebSocket
2025-06-14 16:26:54,100 - INFO - Client disconnected from WebSocket
2025-06-14 16:28:12,903 - INFO - Client disconnected from WebSocket
2025-06-14 16:28:35,392 - INFO - Client disconnected from WebSocket
2025-06-14 16:29:00,928 - INFO - Client disconnected from WebSocket
2025-06-14 16:29:43,695 - INFO - chat_id_enc 
2025-06-14 16:29:44,267 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:44,581 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:44,756 - INFO - Created new chat with ID 2 and UUID b05a7b17-3bc6-4f8f-88ff-7d2536b95273 for user 1
2025-06-14 16:29:44,756 - INFO - b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:44,756 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:44,757 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:44,760 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:44,760 - INFO - Processing query for user_id 1: hey
2025-06-14 16:29:44,761 - INFO - Generated unique_id_with_template: uid_ac8de9f3a82b4d098dff9435ce4a09e4
2025-06-14 16:29:45,290 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:45,325 - INFO - Intent classification: chat
2025-06-14 16:29:45,326 - INFO - Final prompt created with unique_id_with_template: uid_ac8de9f3a82b4d098dff9435ce4a09e4
2025-06-14 16:29:45,881 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:47,983 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:47,983 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:47,984 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:47,987 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:47,988 - INFO - Processing query for user_id 1: i
2025-06-14 16:29:47,988 - INFO - Generated unique_id_with_template: uid_d29a9231c939415a9f13ae8b6530e992
2025-06-14 16:29:48,358 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:48,385 - INFO - Intent classification: chat
2025-06-14 16:29:48,385 - INFO - Final prompt created with unique_id_with_template: uid_d29a9231c939415a9f13ae8b6530e992
2025-06-14 16:29:48,904 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:51,055 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:51,055 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:51,056 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:51,060 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:51,061 - INFO - Processing query for user_id 1: love
2025-06-14 16:29:51,061 - INFO - Generated unique_id_with_template: uid_416e400a3278461dbf35def2b5c76230
2025-06-14 16:29:51,460 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:51,478 - INFO - Intent classification: chat
2025-06-14 16:29:51,478 - INFO - Final prompt created with unique_id_with_template: uid_416e400a3278461dbf35def2b5c76230
2025-06-14 16:29:51,786 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:53,525 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:53,525 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:53,527 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:53,530 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:53,531 - INFO - Processing query for user_id 1: you
2025-06-14 16:29:53,531 - INFO - Generated unique_id_with_template: uid_cf680931498048beb0b0dcbe1893ba41
2025-06-14 16:29:54,211 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:54,247 - INFO - Intent classification: chat
2025-06-14 16:29:54,248 - INFO - Final prompt created with unique_id_with_template: uid_cf680931498048beb0b0dcbe1893ba41
2025-06-14 16:29:54,546 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:56,359 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:56,359 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:56,360 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:56,363 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:56,364 - INFO - Processing query for user_id 1: so
2025-06-14 16:29:56,364 - INFO - Generated unique_id_with_template: uid_1f67c901fb1c421686129af6c7d6f500
2025-06-14 16:29:56,877 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:56,914 - INFO - Intent classification: chat
2025-06-14 16:29:56,914 - INFO - Final prompt created with unique_id_with_template: uid_1f67c901fb1c421686129af6c7d6f500
2025-06-14 16:29:57,555 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:29:59,671 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:29:59,671 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:29:59,672 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:29:59,677 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:29:59,677 - INFO - Processing query for user_id 1: much
2025-06-14 16:29:59,677 - INFO - Generated unique_id_with_template: uid_759420d0e36c4c36b62b28bdaa321f69
2025-06-14 16:30:00,061 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:30:00,076 - INFO - Intent classification: chat
2025-06-14 16:30:00,077 - INFO - Final prompt created with unique_id_with_template: uid_759420d0e36c4c36b62b28bdaa321f69
2025-06-14 16:30:00,410 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:30:05,096 - INFO - Client disconnected from WebSocket
2025-06-14 16:30:24,953 - INFO - Client disconnected from WebSocket
2025-06-14 16:32:17,978 - INFO - Client disconnected from WebSocket
2025-06-14 16:33:52,550 - INFO - Client disconnected from WebSocket
2025-06-14 16:34:14,527 - INFO - Client disconnected from WebSocket
2025-06-14 16:36:35,785 - INFO - Client disconnected from WebSocket
2025-06-14 16:36:51,489 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:36:51,490 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:36:51,491 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:36:51,497 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:36:51,498 - INFO - Processing query for user_id 1: whats ur name?
2025-06-14 16:36:51,498 - INFO - Generated unique_id_with_template: uid_8882fcafafbb4d86a0eeb8c32f9412e0
2025-06-14 16:36:52,948 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:36:52,992 - INFO - Intent classification: chat
2025-06-14 16:36:52,992 - INFO - Final prompt created with unique_id_with_template: uid_8882fcafafbb4d86a0eeb8c32f9412e0
2025-06-14 16:36:53,339 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:01,625 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:01,626 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:01,627 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:01,632 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:01,633 - INFO - Processing query for user_id 1: oh cool thought ur reviewbot
2025-06-14 16:37:01,633 - INFO - Generated unique_id_with_template: uid_3f7925de5e4e408392208a3e1c38a0e3
2025-06-14 16:37:02,041 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:02,068 - INFO - Intent classification: chat
2025-06-14 16:37:02,069 - INFO - Final prompt created with unique_id_with_template: uid_3f7925de5e4e408392208a3e1c38a0e3
2025-06-14 16:37:02,466 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:10,705 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:10,705 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:10,706 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:10,710 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:10,711 - INFO - Processing query for user_id 1: lol so ur from openai
2025-06-14 16:37:10,712 - INFO - Generated unique_id_with_template: uid_31cf607f777d489f9f82efa20bb3bbe5
2025-06-14 16:37:11,108 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:11,135 - INFO - Intent classification: chat
2025-06-14 16:37:11,135 - INFO - Final prompt created with unique_id_with_template: uid_31cf607f777d489f9f82efa20bb3bbe5
2025-06-14 16:37:11,509 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:21,090 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:21,090 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:21,091 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:21,096 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:21,097 - INFO - Processing query for user_id 1: why did they lie they built u then
2025-06-14 16:37:21,097 - INFO - Generated unique_id_with_template: uid_55a98bb5a81749109110cec7a4a4dfd8
2025-06-14 16:37:21,510 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:21,521 - INFO - Intent classification: chat
2025-06-14 16:37:21,521 - INFO - Final prompt created with unique_id_with_template: uid_55a98bb5a81749109110cec7a4a4dfd8
2025-06-14 16:37:21,835 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:38,921 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:38,921 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:38,922 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:38,926 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:38,927 - INFO - Processing query for user_id 1: shitgpt
2025-06-14 16:37:38,927 - INFO - Generated unique_id_with_template: uid_695698ee09de40368a3765bf46d41f69
2025-06-14 16:37:39,316 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:39,375 - INFO - Intent classification: chat
2025-06-14 16:37:39,375 - INFO - Final prompt created with unique_id_with_template: uid_695698ee09de40368a3765bf46d41f69
2025-06-14 16:37:39,674 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:43,641 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:43,641 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:43,642 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:43,647 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:43,648 - INFO - Processing query for user_id 1: lol
2025-06-14 16:37:43,648 - INFO - Generated unique_id_with_template: uid_f802d6830d4742b5b1005a6e1998d87c
2025-06-14 16:37:44,334 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:44,372 - INFO - Intent classification: chat
2025-06-14 16:37:44,372 - INFO - Final prompt created with unique_id_with_template: uid_f802d6830d4742b5b1005a6e1998d87c
2025-06-14 16:37:44,724 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:49,817 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:49,817 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:49,818 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:49,821 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:49,822 - INFO - Processing query for user_id 1: what can u do
2025-06-14 16:37:49,822 - INFO - Generated unique_id_with_template: uid_f5e140efb173420ca36bc0a1946ce133
2025-06-14 16:37:50,190 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:50,216 - INFO - Intent classification: chat
2025-06-14 16:37:50,216 - INFO - Final prompt created with unique_id_with_template: uid_f5e140efb173420ca36bc0a1946ce133
2025-06-14 16:37:50,545 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:53,921 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:37:53,921 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:37:53,922 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:37:53,927 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:37:53,927 - INFO - Processing query for user_id 1: do it
2025-06-14 16:37:53,928 - INFO - Generated unique_id_with_template: uid_8ef73e2dfc6a45c6b67a496c45bbf806
2025-06-14 16:37:54,311 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:37:54,337 - INFO - Intent classification: chat
2025-06-14 16:37:54,337 - INFO - Final prompt created with unique_id_with_template: uid_8ef73e2dfc6a45c6b67a496c45bbf806
2025-06-14 16:37:55,055 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:15,705 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:38:15,705 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:38:15,706 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:38:15,711 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:38:15,711 - INFO - Processing query for user_id 1: ok cool no p
2025-06-14 16:38:15,712 - INFO - Generated unique_id_with_template: uid_b60915feb7c74e9ea463cda7c2fc4540
2025-06-14 16:38:16,168 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:16,194 - INFO - Intent classification: chat
2025-06-14 16:38:16,194 - INFO - Final prompt created with unique_id_with_template: uid_b60915feb7c74e9ea463cda7c2fc4540
2025-06-14 16:38:16,508 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:18,217 - INFO - Client disconnected from WebSocket
2025-06-14 16:38:26,657 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:38:26,657 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:38:26,658 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:38:26,663 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:38:26,664 - INFO - Processing query for user_id 1: ok list my users
2025-06-14 16:38:26,664 - INFO - Generated unique_id_with_template: uid_0a3f9abf7499439cba26ab0b3267d097
2025-06-14 16:38:27,076 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:27,101 - INFO - Intent classification: sql
2025-06-14 16:38:27,116 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-14 16:38:27,542 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:28,281 - INFO - Generated SQL Query for user_id 1:
SELECT id,
       name,
       email,
       user_id,
       platform_id,
       full_name,
       SOURCE,
       created_at,
       updated_at
FROM platform_users
WHERE owner_id = 1
2025-06-14 16:38:28,282 - INFO - Raw DB data retrieved: 5 rows
2025-06-14 16:38:28,283 - INFO - Sample data: {'id': 1, 'name': 'prebad50@gmail.com', 'email': 'prebad50@gmail.com', 'user_id': '0a996c49-4f8f-4af7-9414-01aa7759bb08', 'platform_id': 1, 'full_name': 'prebad50@gmail.com', 'SOURCE': 'linear', 'created_at': datetime.datetime(2025, 6, 1, 9, 2, 23), 'updated_at': datetime.datetime(2025, 6, 1, 9, 2, 23)}
2025-06-14 16:38:28,283 - INFO - Final prompt created with unique_id_with_template: uid_0a3f9abf7499439cba26ab0b3267d097
2025-06-14 16:38:28,776 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:30,922 - ERROR - Streaming error: 
2025-06-14 16:38:56,225 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:38:56,225 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:38:56,226 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:38:56,230 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:38:56,231 - INFO - Processing query for user_id 1: ??
2025-06-14 16:38:56,231 - INFO - Generated unique_id_with_template: uid_825bd3e9babd468392ee965efcfef42a
2025-06-14 16:38:56,635 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:38:56,662 - INFO - Intent classification: chat
2025-06-14 16:38:56,662 - INFO - Final prompt created with unique_id_with_template: uid_825bd3e9babd468392ee965efcfef42a
2025-06-14 16:38:56,985 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:39:03,329 - INFO - chat_id_enc b05a7b17-3bc6-4f8f-88ff-7d2536b95273
2025-06-14 16:39:03,330 - INFO - Executing chat history query for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-14 16:39:03,332 - INFO - Saving message to DB for chat_id b05a7b17-3bc6-4f8f-88ff-7d2536b95273, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-14 16:39:03,344 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-14 16:39:03,347 - INFO - Processing query for user_id 1: message not completed
2025-06-14 16:39:03,347 - INFO - Generated unique_id_with_template: uid_59c8811399334b66bb1a389e6755b9ac
2025-06-14 16:39:03,786 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:39:03,820 - INFO - Intent classification: chat
2025-06-14 16:39:03,820 - INFO - Final prompt created with unique_id_with_template: uid_59c8811399334b66bb1a389e6755b9ac
2025-06-14 16:39:04,568 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-14 16:42:28,857 - INFO - Client disconnected from WebSocket
2025-06-14 16:45:25,017 - INFO - Client disconnected from WebSocket
2025-06-14 16:46:05,004 - INFO - Client disconnected from WebSocket
2025-06-14 16:46:32,330 - INFO - Client disconnected from WebSocket
2025-06-14 16:46:59,266 - INFO - Client disconnected from WebSocket
2025-06-14 16:51:16,811 - INFO - Client disconnected from WebSocket
2025-06-14 16:53:00,560 - INFO - Client disconnected from WebSocket
2025-06-14 18:02:02,595 - INFO - Client disconnected from WebSocket
2025-06-14 18:13:32,444 - INFO - Client disconnected from WebSocket
2025-06-15 08:20:34,281 - INFO - chat_id_enc 
2025-06-15 08:20:34,889 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:20:35,411 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:20:35,549 - ERROR - Error creating new chat: (2006, "MySQL server has gone away (BrokenPipeError(32, 'Broken pipe'))")
2025-06-15 08:20:55,977 - INFO - chat_id_enc 
2025-06-15 08:20:56,329 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:20:56,701 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:20:57,153 - INFO - Created new chat with ID 3 and UUID 3c83c8f2-e559-4200-a6f5-35d539ca813d for user 1
2025-06-15 08:20:57,153 - INFO - 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:20:57,153 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:20:57,156 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:20:57,160 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:20:57,162 - INFO - Processing query for user_id 1: hey sup
2025-06-15 08:20:57,162 - INFO - Generated unique_id_with_template: uid_a20dcc6dd1354bbc9db08c079db91c14
2025-06-15 08:20:57,749 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:20:57,777 - INFO - Intent classification: chat
2025-06-15 08:20:57,777 - INFO - Final prompt created with unique_id_with_template: uid_a20dcc6dd1354bbc9db08c079db91c14
2025-06-15 08:20:58,243 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:21:08,921 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:21:08,921 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:21:08,922 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:21:08,926 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:21:08,927 - INFO - Processing query for user_id 1: m good.. what has my team done in the past week
2025-06-15 08:21:08,928 - INFO - Generated unique_id_with_template: uid_e096872a930c40799dc13279dd9ef9f5
2025-06-15 08:21:09,398 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:21:09,424 - INFO - Intent classification: sql
2025-06-15 08:21:09,441 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:21:09,848 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:21:11,714 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.description,
       t.status,
       t.priority,
       t.estimate,
       t.due_date,
       t.created_at,
       t.updated_at,
       pu.full_name AS user_name,
       tm.name AS team_name
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
JOIN teams tm ON t.team_id = tm.platform_id
WHERE t.owner_id = 1
  AND tm.owner_id = 1
  AND pu.owner_id = 1
  AND t.created_at >= NOW() - INTERVAL 1 WEEK
2025-06-15 08:21:11,716 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 08:21:11,716 - WARNING - No data returned from SQL query
2025-06-15 08:21:11,717 - INFO - Final prompt created with unique_id_with_template: uid_e096872a930c40799dc13279dd9ef9f5
2025-06-15 08:21:12,039 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:22:05,256 - INFO - Client disconnected from WebSocket
2025-06-15 08:22:35,406 - INFO - Client disconnected from WebSocket
2025-06-15 08:23:44,239 - INFO - Client disconnected from WebSocket
2025-06-15 08:23:54,740 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:23:54,740 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:23:54,741 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:23:54,745 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:23:54,746 - INFO - Processing query for user_id 1: m talking about what my team have done in the pas week
2025-06-15 08:23:54,746 - INFO - Generated unique_id_with_template: uid_2d28cbfeee6f41b58e5fa7d271722ece
2025-06-15 08:23:55,145 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:23:55,172 - INFO - Intent classification: sql
2025-06-15 08:23:55,189 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:23:56,332 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:23:58,376 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.status,
       t.created_at,
       t.updated_at,
       p.full_name AS user_name,
       tm.name AS team_name
FROM tasks t
JOIN platform_users p ON t.user_id = p.user_id
JOIN teams tm ON t.team_id = tm.platform_id
WHERE t.owner_id = 1
  AND tm.owner_id = 1
  AND p.owner_id = 1
  AND t.created_at >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)
ORDER BY t.updated_at DESC;
2025-06-15 08:23:58,378 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 08:23:58,378 - WARNING - No data returned from SQL query
2025-06-15 08:23:58,378 - INFO - Final prompt created with unique_id_with_template: uid_2d28cbfeee6f41b58e5fa7d271722ece
2025-06-15 08:23:58,721 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:24:47,291 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:24:47,291 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:24:47,292 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:24:47,299 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:24:47,299 - INFO - Processing query for user_id 1: what about the past months
2025-06-15 08:24:47,300 - INFO - Generated unique_id_with_template: uid_d83d27a92d5a4b9dad8fec20e62197fa
2025-06-15 08:24:47,674 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:24:47,699 - INFO - Intent classification: sql
2025-06-15 08:24:47,706 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:24:48,407 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:24:50,107 - INFO - Generated SQL Query for user_id 1:
SELECT t.id,
       t.title,
       t.status,
       t.priority,
       t.estimate,
       t.due_date,
       t.created_at,
       t.updated_at,
       pu.full_name AS user_name,
       tm.name AS team_name,
       p.name AS project_name
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
AND t.owner_id = pu.owner_id
JOIN teams tm ON t.team_id = tm.platform_id
AND t.owner_id = tm.owner_id
LEFT JOIN projects p ON t.project_id IS NULL -- project_id is always null

WHERE t.owner_id = 1
  AND t.created_at >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)
ORDER BY t.created_at DESC;
2025-06-15 08:24:50,109 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 08:24:50,109 - WARNING - No data returned from SQL query
2025-06-15 08:24:50,109 - INFO - Final prompt created with unique_id_with_template: uid_d83d27a92d5a4b9dad8fec20e62197fa
2025-06-15 08:24:50,737 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:25:26,102 - INFO - Client disconnected from WebSocket
2025-06-15 08:26:08,029 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:26:08,030 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:26:08,031 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:26:08,035 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:26:08,036 - INFO - Processing query for user_id 1: cool
2025-06-15 08:26:08,036 - INFO - Generated unique_id_with_template: uid_51e60ba1ae4a4691a53a243c512b5379
2025-06-15 08:26:08,474 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:08,504 - INFO - Intent classification: chat
2025-06-15 08:26:08,505 - INFO - Final prompt created with unique_id_with_template: uid_51e60ba1ae4a4691a53a243c512b5379
2025-06-15 08:26:08,909 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:16,210 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:26:16,211 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:26:16,212 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:26:16,215 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:26:16,216 - INFO - Processing query for user_id 1: this is not a breakdown sha
2025-06-15 08:26:16,216 - INFO - Generated unique_id_with_template: uid_08781081313348d3af521951f1e680da
2025-06-15 08:26:16,798 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:16,853 - INFO - Intent classification: chat
2025-06-15 08:26:16,853 - INFO - Final prompt created with unique_id_with_template: uid_08781081313348d3af521951f1e680da
2025-06-15 08:26:17,394 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:21,440 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:26:21,440 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:26:21,442 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:26:21,446 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:26:21,447 - INFO - Processing query for user_id 1: more breakdown
2025-06-15 08:26:21,447 - INFO - Generated unique_id_with_template: uid_951b32c18b5840a2b3336ee459dd56ce
2025-06-15 08:26:21,857 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:21,886 - INFO - Intent classification: sql
2025-06-15 08:26:21,910 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:26:22,643 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:24,763 - INFO - Generated SQL Query for user_id 1:
SELECT t.id,
       t.title,
       t.status,
       t.priority,
       t.estimate,
       t.due_date,
       p.name AS project_name,
       pu.full_name AS user_name,
       tm.name AS team_name
FROM tasks t
JOIN projects p ON t.project_id = p.id
JOIN platform_users pu ON t.user_id = pu.user_id
JOIN teams tm ON t.team_id = tm.id
WHERE t.owner_id = 1
  AND t.created_at >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)
ORDER BY t.created_at DESC;
2025-06-15 08:26:24,764 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 08:26:24,764 - WARNING - No data returned from SQL query
2025-06-15 08:26:24,765 - INFO - Final prompt created with unique_id_with_template: uid_951b32c18b5840a2b3336ee459dd56ce
2025-06-15 08:26:25,123 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:26:58,110 - INFO - Client disconnected from WebSocket
2025-06-15 08:27:07,838 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:27:07,838 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:27:07,839 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:27:07,845 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:27:07,846 - INFO - Processing query for user_id 1: what did they do last two months
2025-06-15 08:27:07,846 - INFO - Generated unique_id_with_template: uid_c07b54b594a2470a99fa33279a6e4f7e
2025-06-15 08:27:08,258 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:27:08,284 - INFO - Intent classification: sql
2025-06-15 08:27:08,294 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:27:09,268 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:27:10,824 - INFO - Generated SQL Query for user_id 1:
SELECT tasks.title,
       tasks.status,
       tasks.created_at,
       tasks.updated_at,
       platform_users.full_name,
       teams.name AS team_name,
       projects.name AS project_name
FROM tasks
JOIN platform_users ON tasks.user_id = platform_users.user_id
JOIN teams ON tasks.team_id = teams.team_key
JOIN projects ON tasks.project_id = projects.project_key
WHERE tasks.owner_id = 1
  AND tasks.created_at >= DATE_SUB(CURDATE(), INTERVAL 2 MONTH)
  AND tasks.created_at < DATE_SUB(CURDATE(), INTERVAL 1 MONTH)
  AND tasks.is_deleted = 0
ORDER BY tasks.created_at DESC;
2025-06-15 08:27:10,826 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 08:27:10,826 - WARNING - No data returned from SQL query
2025-06-15 08:27:10,827 - INFO - Final prompt created with unique_id_with_template: uid_c07b54b594a2470a99fa33279a6e4f7e
2025-06-15 08:27:12,019 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:29:56,027 - INFO - Client disconnected from WebSocket
2025-06-15 08:29:58,820 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:29:58,820 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:29:58,822 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:29:58,825 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:29:58,825 - INFO - Processing query for user_id 1: more
2025-06-15 08:29:58,826 - INFO - Generated unique_id_with_template: uid_0598717a08f948fe835bf153da9c1e5d
2025-06-15 08:29:59,218 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:29:59,249 - INFO - Intent classification: chat
2025-06-15 08:29:59,249 - INFO - Final prompt created with unique_id_with_template: uid_0598717a08f948fe835bf153da9c1e5d
2025-06-15 08:29:59,600 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:30:14,371 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:30:14,371 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:30:14,372 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:30:14,376 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:30:14,377 - INFO - Processing query for user_id 1: what have they completed then
2025-06-15 08:30:14,377 - INFO - Generated unique_id_with_template: uid_e2bb6299fc6748fc8d784b0612dbc076
2025-06-15 08:30:14,763 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:30:14,789 - INFO - Intent classification: sql
2025-06-15 08:30:14,798 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:30:15,158 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:30:16,694 - INFO - Generated SQL Query for user_id 1:
SELECT tasks.title,
       tasks.description,
       tasks.status,
       tasks.created_at,
       tasks.updated_at,
       platform_users.full_name
FROM tasks
JOIN platform_users ON tasks.user_id = platform_users.user_id
WHERE tasks.status = 'Done'
  AND tasks.owner_id = 1
  AND tasks.created_at >= DATE_SUB(NOW(), INTERVAL 2 MONTH)
2025-06-15 08:30:16,696 - INFO - Raw DB data retrieved: 4 rows
2025-06-15 08:30:16,697 - INFO - Sample data: {'title': 'ok', 'description': None, 'status': 'Done', 'created_at': datetime.datetime(2025, 5, 8, 6, 33, 43), 'updated_at': datetime.datetime(2025, 5, 8, 6, 33, 43), 'full_name': 'allphonesblog ng'}
2025-06-15 08:30:16,697 - INFO - Final prompt created with unique_id_with_template: uid_e2bb6299fc6748fc8d784b0612dbc076
2025-06-15 08:30:17,095 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:35,581 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:31:35,582 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:31:35,583 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:31:35,586 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:31:35,587 - INFO - Processing query for user_id 1: just kept loading
2025-06-15 08:31:35,587 - INFO - Generated unique_id_with_template: uid_5340e53b947947a5b0d1bc5e1309e35d
2025-06-15 08:31:36,054 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:36,119 - INFO - Intent classification: chat
2025-06-15 08:31:36,119 - INFO - Final prompt created with unique_id_with_template: uid_5340e53b947947a5b0d1bc5e1309e35d
2025-06-15 08:31:36,483 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:41,051 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:31:41,051 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:31:41,053 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:31:41,058 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:31:41,059 - INFO - Processing query for user_id 1: again
2025-06-15 08:31:41,059 - INFO - Generated unique_id_with_template: uid_bb5f5cf4fcdf4e3b996ae2b792b75261
2025-06-15 08:31:41,443 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:41,468 - INFO - Intent classification: chat
2025-06-15 08:31:41,468 - INFO - Final prompt created with unique_id_with_template: uid_bb5f5cf4fcdf4e3b996ae2b792b75261
2025-06-15 08:31:41,806 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:48,667 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:31:48,668 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:31:48,669 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:31:48,672 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:31:48,673 - INFO - Processing query for user_id 1: give what they have done
2025-06-15 08:31:48,673 - INFO - Generated unique_id_with_template: uid_a750b63413a74f16aa8178bcd7db56be
2025-06-15 08:31:49,703 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:49,727 - INFO - Intent classification: sql
2025-06-15 08:31:49,735 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:31:50,108 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:31:50,820 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.description,
       t.status,
       t.created_at,
       t.updated_at,
       pu.full_name
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.status = 'Done'
  AND t.owner_id = 1
2025-06-15 08:31:50,823 - INFO - Raw DB data retrieved: 28 rows
2025-06-15 08:31:50,823 - INFO - Sample data: {'title': 'ok', 'description': None, 'status': 'Done', 'created_at': datetime.datetime(2025, 5, 8, 6, 33, 43), 'updated_at': datetime.datetime(2025, 5, 8, 6, 33, 43), 'full_name': 'allphonesblog ng'}
2025-06-15 08:31:50,824 - INFO - Final prompt created with unique_id_with_template: uid_a750b63413a74f16aa8178bcd7db56be
2025-06-15 08:31:51,248 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:32:30,572 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:32:30,572 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:32:30,573 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:32:30,577 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:32:30,578 - INFO - Processing query for user_id 1: give only pie chart of what they have done
2025-06-15 08:32:30,578 - INFO - Generated unique_id_with_template: uid_93ed05b5a8d24565a46a46b85d73e01d
2025-06-15 08:32:30,996 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:32:31,026 - INFO - Intent classification: sql
2025-06-15 08:32:31,033 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:32:31,986 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:32:32,812 - INFO - Generated SQL Query for user_id 1:
SELECT status,
       COUNT(*) AS COUNT
FROM tasks
WHERE owner_id = 1
GROUP BY status This query will provide the DATA needed TO
CREATE a pie chart showing the distribution OF task statuses (e.g., "Done", "In Progress", "Backlog", "Todo")
FOR tasks owned BY the specified owner.
2025-06-15 08:32:32,813 - ERROR - SQL Query Error for user_id 1: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'This query will provide the DATA needed TO\nCREATE a pie chart showing the distri' at line 5")
2025-06-15 08:32:32,813 - INFO - Final prompt created with unique_id_with_template: uid_93ed05b5a8d24565a46a46b85d73e01d
2025-06-15 08:32:33,153 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:37:09,392 - INFO - Client disconnected from WebSocket
2025-06-15 08:46:03,666 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:46:03,667 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:46:03,668 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:46:03,672 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:46:03,673 - INFO - Processing query for user_id 1: again
2025-06-15 08:46:03,674 - INFO - Generated unique_id_with_template: uid_deed5058e0b74bf7a425ed5c13fc3f8b
2025-06-15 08:46:04,119 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:46:04,152 - INFO - Intent classification: chat
2025-06-15 08:46:04,152 - INFO - Final prompt created with unique_id_with_template: uid_deed5058e0b74bf7a425ed5c13fc3f8b
2025-06-15 08:46:04,618 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:52:37,466 - INFO - Client disconnected from WebSocket
2025-06-15 08:52:41,420 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:52:41,421 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:52:41,422 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:52:41,427 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:52:41,427 - INFO - Processing query for user_id 1: again
2025-06-15 08:52:41,427 - INFO - Generated unique_id_with_template: uid_442b1b82442d42eaa23586fd0cd8ee6d
2025-06-15 08:52:41,856 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:52:41,883 - INFO - Intent classification: chat
2025-06-15 08:52:41,883 - INFO - Final prompt created with unique_id_with_template: uid_442b1b82442d42eaa23586fd0cd8ee6d
2025-06-15 08:52:42,479 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:53:23,600 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 08:53:23,600 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 08:53:23,602 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 08:53:23,607 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 08:53:23,608 - INFO - Processing query for user_id 1: ok u know what.. give a table and bar chart
2025-06-15 08:53:23,608 - INFO - Generated unique_id_with_template: uid_cb9cc7f8f8cc4d4babd34a0950f37d2d
2025-06-15 08:53:24,044 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:53:24,079 - INFO - Intent classification: sql
2025-06-15 08:53:24,095 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 08:53:24,598 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 08:53:25,081 - INFO - Generated SQL Query for user_id 1:
SELECT title,
       COUNT(*) AS task_count
FROM tasks
WHERE status = 'Done'
  AND created_at BETWEEN '2025-03-01' AND '2025-05-01'
  AND owner_id = 1
GROUP BY title
2025-06-15 08:53:25,082 - INFO - Raw DB data retrieved: 12 rows
2025-06-15 08:53:25,082 - INFO - Sample data: {'title': 'members page', 'task_count': 1}
2025-06-15 08:53:25,083 - INFO - Final prompt created with unique_id_with_template: uid_cb9cc7f8f8cc4d4babd34a0950f37d2d
2025-06-15 08:53:25,486 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:04:57,737 - INFO - Client disconnected from WebSocket
2025-06-15 09:05:13,056 - INFO - chat_id_enc 3c83c8f2-e559-4200-a6f5-35d539ca813d
2025-06-15 09:05:13,056 - INFO - Executing chat history query for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:05:13,059 - INFO - Saving message to DB for chat_id 3c83c8f2-e559-4200-a6f5-35d539ca813d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:05:13,063 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:05:13,064 - INFO - Processing query for user_id 1: again
2025-06-15 09:05:13,064 - INFO - Generated unique_id_with_template: uid_0c1c4077d9d8418abf9e440cb3b86493
2025-06-15 09:05:14,170 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:05:14,201 - INFO - Intent classification: chat
2025-06-15 09:05:14,202 - INFO - Final prompt created with unique_id_with_template: uid_0c1c4077d9d8418abf9e440cb3b86493
2025-06-15 09:05:14,619 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:19,310 - INFO - Client disconnected from WebSocket
2025-06-15 09:11:34,440 - INFO - chat_id_enc 
2025-06-15 09:11:34,821 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:35,285 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:35,494 - INFO - Created new chat with ID 1 and UUID f2cd2c07-66e6-488a-973a-ba986a4ec786 for user 1
2025-06-15 09:11:35,494 - INFO - f2cd2c07-66e6-488a-973a-ba986a4ec786
2025-06-15 09:11:35,494 - INFO - Executing chat history query for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:11:35,495 - INFO - Saving message to DB for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:11:35,504 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:11:35,505 - INFO - Processing query for user_id 1: sup
2025-06-15 09:11:35,505 - INFO - Generated unique_id_with_template: uid_54d5cabc1fa34a9d9853f5b8afd7da2e
2025-06-15 09:11:35,883 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:35,934 - INFO - Intent classification: chat
2025-06-15 09:11:35,935 - INFO - Final prompt created with unique_id_with_template: uid_54d5cabc1fa34a9d9853f5b8afd7da2e
2025-06-15 09:11:36,843 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:43,608 - INFO - chat_id_enc f2cd2c07-66e6-488a-973a-ba986a4ec786
2025-06-15 09:11:43,608 - INFO - Executing chat history query for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:11:43,609 - INFO - Saving message to DB for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:11:43,614 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:11:43,615 - INFO - Processing query for user_id 1: Which team member has the highest task completion rate?
2025-06-15 09:11:43,615 - INFO - Generated unique_id_with_template: uid_a5b9eb0ae4c74ce4b4593015d02881f1
2025-06-15 09:11:44,136 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:44,188 - INFO - Intent classification: sql
2025-06-15 09:11:44,196 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:11:44,531 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:11:45,534 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name,
       COUNT(t.id) AS total_tasks,
       SUM(CASE
               WHEN t.status = 'Done' THEN 1
               ELSE 0
           END) AS completed_tasks,
       (SUM(CASE
                WHEN t.status = 'Done' THEN 1
                ELSE 0
            END) / COUNT(t.id)) * 100 AS completion_rate
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.owner_id = 1
GROUP BY pu.full_name
ORDER BY completion_rate DESC
LIMIT 1
2025-06-15 09:11:45,536 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:11:45,536 - INFO - Sample data: {'full_name': 'thinksmartwealth@gmail.com', 'total_tasks': 12, 'completed_tasks': Decimal('12'), 'completion_rate': Decimal('100.0000')}
2025-06-15 09:11:45,536 - ERROR - SQL Query Error for user_id 1: Object of type Decimal is not JSON serializable
2025-06-15 09:11:45,537 - INFO - Final prompt created with unique_id_with_template: uid_a5b9eb0ae4c74ce4b4593015d02881f1
2025-06-15 09:11:45,852 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:22:28,031 - INFO - chat_id_enc f2cd2c07-66e6-488a-973a-ba986a4ec786
2025-06-15 09:22:28,032 - INFO - Executing chat history query for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:22:28,033 - INFO - Saving message to DB for chat_id f2cd2c07-66e6-488a-973a-ba986a4ec786, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:22:28,038 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:22:28,040 - INFO - Processing query for user_id 1: again
2025-06-15 09:22:28,040 - INFO - Generated unique_id_with_template: uid_4e66448f35324206975d93bbf5a6db92
2025-06-15 09:22:28,583 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:22:28,612 - INFO - Intent classification: chat
2025-06-15 09:22:28,613 - INFO - Final prompt created with unique_id_with_template: uid_4e66448f35324206975d93bbf5a6db92
2025-06-15 09:22:28,952 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:22:48,049 - INFO - Client disconnected from WebSocket
2025-06-15 09:23:28,671 - INFO - Client disconnected from WebSocket
2025-06-15 09:23:33,664 - INFO - chat_id_enc 
2025-06-15 09:23:34,101 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:34,541 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:34,687 - INFO - Created new chat with ID 1 and UUID f8709189-87d4-41f5-a5df-90e5d385e2b2 for user 1
2025-06-15 09:23:34,688 - INFO - f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:23:34,688 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:23:34,690 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:23:34,694 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:23:34,695 - INFO - Processing query for user_id 1: How many bugs were resolved this week compared to last week?
2025-06-15 09:23:34,695 - INFO - Generated unique_id_with_template: uid_b858572b4a204c03bec31d706cd090d7
2025-06-15 09:23:35,184 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:35,286 - INFO - Intent classification: sql
2025-06-15 09:23:35,294 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:23:35,978 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:37,020 - INFO - Generated SQL Query for user_id 1:
SELECT SUM(CASE
               WHEN WEEK(tasks.updated_at) = WEEK(CURDATE())
                    AND tasks.status = 'Done' THEN 1
               ELSE 0
           END) AS bugs_resolved_this_week,
       SUM(CASE
               WHEN WEEK(tasks.updated_at) = WEEK(CURDATE()) - 1
                    AND tasks.status = 'Done' THEN 1
               ELSE 0
           END) AS bugs_resolved_last_week
FROM tasks
WHERE tasks.owner_id = 1
  AND tasks.title LIKE '%bug%'
2025-06-15 09:23:37,021 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:23:37,022 - INFO - Sample data: {'bugs_resolved_this_week': None, 'bugs_resolved_last_week': None}
2025-06-15 09:23:37,022 - INFO - Final prompt created with unique_id_with_template: uid_b858572b4a204c03bec31d706cd090d7
2025-06-15 09:23:37,371 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:47,637 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:23:47,637 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:23:47,639 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:23:47,653 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:23:47,654 - INFO - Processing query for user_id 1: What is the burn-down rate for the current sprint?
2025-06-15 09:23:47,654 - INFO - Generated unique_id_with_template: uid_26315eec54514dc087c7a181e97d6cc4
2025-06-15 09:23:48,025 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:48,052 - INFO - Intent classification: sql
2025-06-15 09:23:48,062 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:23:48,426 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:50,060 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.status,
       t.estimate,
       t.created_at,
       t.due_date,
       p.name AS project_name,
       tm.name AS team_name,
       pu.full_name AS user_name
FROM tasks t
JOIN projects p ON t.project_id = p.id
JOIN teams tm ON t.team_id = tm.platform_id
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.owner_id = 1
  AND t.status IN ('In Progress',
                   'Done')
  AND t.is_deleted = 0
ORDER BY t.due_date;
2025-06-15 09:23:50,062 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:23:50,063 - WARNING - No data returned from SQL query
2025-06-15 09:23:50,063 - INFO - Final prompt created with unique_id_with_template: uid_26315eec54514dc087c7a181e97d6cc4
2025-06-15 09:23:50,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:58,166 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:23:58,166 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:23:58,167 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:23:58,170 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:23:58,171 - INFO - Processing query for user_id 1: Which users are assigned to the most high-priority tasks?
2025-06-15 09:23:58,172 - INFO - Generated unique_id_with_template: uid_9657c9002a804a51823e710dede56ee1
2025-06-15 09:23:58,591 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:23:58,618 - INFO - Intent classification: sql
2025-06-15 09:23:58,627 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:23:59,053 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:24:00,134 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name,
       COUNT(t.id) AS high_priority_task_count
FROM tasks t
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.priority = 1
  AND t.owner_id = 1
GROUP BY pu.full_name
ORDER BY high_priority_task_count DESC
2025-06-15 09:24:00,135 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:24:00,135 - INFO - Sample data: {'full_name': 'thinksmartwealth@gmail.com', 'high_priority_task_count': 4}
2025-06-15 09:24:00,135 - INFO - Final prompt created with unique_id_with_template: uid_9657c9002a804a51823e710dede56ee1
2025-06-15 09:24:00,623 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:24:37,174 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:24:37,175 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:24:37,176 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:24:37,181 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:24:37,183 - INFO - Processing query for user_id 1: What's the velocity trend per sprint in this quarter?
2025-06-15 09:24:37,183 - INFO - Generated unique_id_with_template: uid_cec3db40f7f242d0b0fc20e6f672f61a
2025-06-15 09:24:37,585 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:24:37,615 - INFO - Intent classification: sql
2025-06-15 09:24:37,623 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:24:37,973 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:24:39,178 - INFO - Generated SQL Query for user_id 1:
SELECT s.sprint_id,
       SUM(t.estimate) AS total_estimated_hours
FROM tasks t
JOIN sprints s ON t.sprint_id = s.id
WHERE t.owner_id = 1
  AND s.quarter = 'current_quarter'
  AND t.status = 'Done'
GROUP BY s.sprint_id
ORDER BY s.sprint_id;
2025-06-15 09:24:39,179 - ERROR - SQL Query Error for user_id 1: (1146, "Table 'db.sprints' doesn't exist")
2025-06-15 09:24:39,180 - INFO - Final prompt created with unique_id_with_template: uid_cec3db40f7f242d0b0fc20e6f672f61a
2025-06-15 09:24:39,532 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:25:39,692 - INFO - Client disconnected from WebSocket
2025-06-15 09:26:21,314 - INFO - Client disconnected from WebSocket
2025-06-15 09:26:29,216 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:26:29,216 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:26:29,217 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:26:29,222 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:26:29,223 - INFO - Processing query for user_id 1: How many bugs were resolved this week compared to last week?
2025-06-15 09:26:29,223 - INFO - Generated unique_id_with_template: uid_d980a06b454943549594e54c988907dc
2025-06-15 09:26:29,654 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:29,684 - INFO - Intent classification: sql
2025-06-15 09:26:29,708 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:26:30,222 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:31,095 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(CASE
                 WHEN status = 'Done'
                      AND WEEK(created_at) = WEEK(CURDATE()) THEN 1
             END) AS bugs_resolved_this_week,
       COUNT(CASE
                 WHEN status = 'Done'
                      AND WEEK(created_at) = WEEK(CURDATE()) - 1 THEN 1
             END) AS bugs_resolved_last_week
FROM tasks
WHERE labels LIKE '%bug%'
  AND owner_id = 1
2025-06-15 09:26:31,097 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:26:31,097 - INFO - Sample data: {'bugs_resolved_this_week': 0, 'bugs_resolved_last_week': 0}
2025-06-15 09:26:31,098 - INFO - Final prompt created with unique_id_with_template: uid_d980a06b454943549594e54c988907dc
2025-06-15 09:26:31,425 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:36,291 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:26:36,291 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:26:36,292 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:26:36,296 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:26:36,296 - INFO - Processing query for user_id 1: How many tasks were added mid-sprint?
2025-06-15 09:26:36,297 - INFO - Generated unique_id_with_template: uid_5ffe66d3f841467e993ee5c3261d1c57
2025-06-15 09:26:36,681 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:36,716 - INFO - Intent classification: sql
2025-06-15 09:26:36,724 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:26:37,318 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:38,530 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS mid_sprint_tasks_count
FROM tasks
WHERE owner_id = 1
  AND created_at >
    (SELECT start_date
     FROM projects
     WHERE id = tasks.project_id)
  AND created_at <
    (SELECT end_date
     FROM projects
     WHERE id = tasks.project_id)
  AND status IN ('In Progress',
                 'Backlog',
                 'Todo')
  AND is_deleted = 0;
2025-06-15 09:26:38,532 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:26:38,532 - INFO - Sample data: {'mid_sprint_tasks_count': 0}
2025-06-15 09:26:38,532 - INFO - Final prompt created with unique_id_with_template: uid_5ffe66d3f841467e993ee5c3261d1c57
2025-06-15 09:26:38,933 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:48,191 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:26:48,192 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:26:48,193 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:26:48,197 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:26:48,197 - INFO - Processing query for user_id 1: What's the average time from bug report to resolution?
2025-06-15 09:26:48,198 - INFO - Generated unique_id_with_template: uid_123e77f06fa7464cafeee7102f7d6694
2025-06-15 09:26:48,566 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:48,591 - INFO - Intent classification: sql
2025-06-15 09:26:48,601 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:26:48,981 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:49,567 - INFO - Generated SQL Query for user_id 1:
SELECT AVG(TIMESTAMPDIFF(HOUR, tasks.created_at, tasks.updated_at)) AS average_resolution_time
FROM tasks
WHERE tasks.labels LIKE '%bug%'
  AND tasks.status = 'Done'
  AND tasks.owner_id = 1;
2025-06-15 09:26:49,569 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:26:49,569 - INFO - Sample data: {'average_resolution_time': None}
2025-06-15 09:26:49,569 - INFO - Final prompt created with unique_id_with_template: uid_123e77f06fa7464cafeee7102f7d6694
2025-06-15 09:26:49,931 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:57,594 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:26:57,594 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:26:57,596 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:26:57,599 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:26:57,600 - INFO - Processing query for user_id 1: Which tasks are most overdue across all projects?
2025-06-15 09:26:57,600 - INFO - Generated unique_id_with_template: uid_86247322c4af4bc788d146e8ae64a446
2025-06-15 09:26:57,989 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:58,034 - INFO - Intent classification: sql
2025-06-15 09:26:58,041 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:26:58,404 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:26:59,433 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.due_date,
       p.name AS project_name,
       pu.full_name AS assigned_user
FROM tasks t
JOIN projects p ON t.project_id = p.platform_id
JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.due_date < CURRENT_DATE
  AND t.status != 'Done'
  AND t.owner_id = 1
ORDER BY t.due_date ASC;
2025-06-15 09:26:59,435 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:26:59,435 - WARNING - No data returned from SQL query
2025-06-15 09:26:59,436 - INFO - Final prompt created with unique_id_with_template: uid_86247322c4af4bc788d146e8ae64a446
2025-06-15 09:26:59,810 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:28:56,634 - INFO - Client disconnected from WebSocket
2025-06-15 09:29:00,622 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:29:00,622 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:29:00,623 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:29:00,628 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:29:00,629 - INFO - Processing query for user_id 1: Which platform (Linear, Trello, Jira) has the highest task completion rate?
2025-06-15 09:29:00,629 - INFO - Generated unique_id_with_template: uid_8773afbb63d045aaaa6ee2947321ef16
2025-06-15 09:29:01,020 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:29:01,051 - INFO - Intent classification: sql
2025-06-15 09:29:01,061 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4 ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:29:01,462 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:29:02,394 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE,
       COUNT(CASE
                 WHEN status = 'Done' THEN 1
             END) * 100.0 / COUNT(*) AS completion_rate
FROM tasks
WHERE owner_id = 1
GROUP BY SOURCE
ORDER BY completion_rate DESC
LIMIT 1
2025-06-15 09:29:02,396 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:29:02,396 - INFO - Sample data: {'SOURCE': 'linear', 'completion_rate': Decimal('30.61224')}
2025-06-15 09:29:02,396 - ERROR - SQL Query Error for user_id 1: Object of type Decimal is not JSON serializable
2025-06-15 09:29:02,397 - INFO - Final prompt created with unique_id_with_template: uid_8773afbb63d045aaaa6ee2947321ef16
2025-06-15 09:29:02,726 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:30:45,606 - INFO - Client disconnected from WebSocket
2025-06-15 09:30:56,261 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:30:56,261 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:30:56,262 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:30:56,265 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:30:56,267 - INFO - Processing query for user_id 1: How many high-priority tasks are still incomplete?
2025-06-15 09:30:56,267 - INFO - Generated unique_id_with_template: uid_a9080afff3fa47b3add15c89669bc6fd
2025-06-15 09:30:56,682 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:30:56,708 - INFO - Intent classification: sql
2025-06-15 09:30:56,723 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:30:57,170 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:30:57,600 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS incomplete_high_priority_tasks
FROM tasks
WHERE status != 'Done'
  AND priority = 1
  AND owner_id = 1;
2025-06-15 09:30:57,601 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:30:57,601 - INFO - Sample data: {'incomplete_high_priority_tasks': 0}
2025-06-15 09:30:57,601 - INFO - Final prompt created with unique_id_with_template: uid_a9080afff3fa47b3add15c89669bc6fd
2025-06-15 09:30:57,994 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:06,321 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:31:06,321 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:31:06,323 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:31:06,326 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:31:06,326 - INFO - Processing query for user_id 1: How many high-priority tasks are still incomplete?
2025-06-15 09:31:06,327 - INFO - Generated unique_id_with_template: uid_7576008b5d334c3a891fc32fb5f5adfa
2025-06-15 09:31:07,395 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:07,479 - INFO - Intent classification: sql
2025-06-15 09:31:07,487 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:31:07,906 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:08,292 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS incomplete_high_priority_tasks
FROM tasks
WHERE priority = 1
  AND status != 'Done'
  AND owner_id = 1;
2025-06-15 09:31:08,293 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:31:08,293 - INFO - Sample data: {'incomplete_high_priority_tasks': 0}
2025-06-15 09:31:08,293 - INFO - Final prompt created with unique_id_with_template: uid_7576008b5d334c3a891fc32fb5f5adfa
2025-06-15 09:31:08,710 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:19,061 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:31:19,062 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:31:19,063 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:31:19,070 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:31:19,071 - INFO - Processing query for user_id 1: What’s the total estimate of all tasks due this week?
2025-06-15 09:31:19,071 - INFO - Generated unique_id_with_template: uid_a6bbac60a5054091a8de561bc18b0fc8
2025-06-15 09:31:19,518 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:19,548 - INFO - Intent classification: sql
2025-06-15 09:31:19,557 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:31:20,044 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:20,545 - INFO - Generated SQL Query for user_id 1:
SELECT SUM(estimate) AS total_estimate
FROM tasks
WHERE due_date BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 7 DAY)
  AND owner_id = 1
  AND is_deleted = 0
2025-06-15 09:31:20,546 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:31:20,546 - INFO - Sample data: {'total_estimate': None}
2025-06-15 09:31:20,546 - INFO - Final prompt created with unique_id_with_template: uid_a6bbac60a5054091a8de561bc18b0fc8
2025-06-15 09:31:20,982 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:37,826 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:31:37,826 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:31:37,827 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:31:37,837 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:31:37,838 - INFO - Processing query for user_id 1: How many tasks are missing due dates?
2025-06-15 09:31:37,838 - INFO - Generated unique_id_with_template: uid_4a2a4673a95c4ae08e9f3984305942c6
2025-06-15 09:31:38,389 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:38,416 - INFO - Intent classification: sql
2025-06-15 09:31:38,427 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:31:38,988 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:39,177 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*)
FROM tasks
WHERE due_date IS NULL
  AND owner_id = 1;
2025-06-15 09:31:39,178 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:31:39,178 - INFO - Sample data: {'COUNT(*)': 37}
2025-06-15 09:31:39,178 - INFO - Final prompt created with unique_id_with_template: uid_4a2a4673a95c4ae08e9f3984305942c6
2025-06-15 09:31:39,622 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:52,938 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:31:52,938 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:31:52,939 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:31:52,942 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:31:52,943 - INFO - Processing query for user_id 1: What’s the ratio of completed to total tasks per project?
2025-06-15 09:31:52,943 - INFO - Generated unique_id_with_template: uid_a10e4fac577140749bea5bdb8d174aef
2025-06-15 09:31:53,362 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:53,393 - INFO - Intent classification: sql
2025-06-15 09:31:53,400 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:31:53,786 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:31:54,777 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS total_tasks,
       SUM(CASE
               WHEN t.status = 'Done' THEN 1
               ELSE 0
           END) AS completed_tasks,
       SUM(CASE
               WHEN t.status = 'Done' THEN 1
               ELSE 0
           END) / COUNT(t.id) AS completion_ratio
FROM tasks t
JOIN projects p ON t.project_id = p.id
WHERE t.owner_id = 1
GROUP BY p.name
2025-06-15 09:31:54,779 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:31:54,779 - WARNING - No data returned from SQL query
2025-06-15 09:31:54,779 - INFO - Final prompt created with unique_id_with_template: uid_a10e4fac577140749bea5bdb8d174aef
2025-06-15 09:31:55,111 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:32:11,514 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:32:11,514 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:32:11,515 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:32:11,521 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:32:11,521 - INFO - Processing query for user_id 1: What’s the average priority level of tasks in each project?
2025-06-15 09:32:11,522 - INFO - Generated unique_id_with_template: uid_18ee18c4798645c7a250d51d4d18143c
2025-06-15 09:32:11,910 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:32:11,935 - INFO - Intent classification: sql
2025-06-15 09:32:11,945 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:32:12,288 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:32:12,997 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       AVG(t.priority) AS average_priority
FROM tasks t
JOIN projects p ON t.project_id = p.id
WHERE t.owner_id = 1
GROUP BY p.name
2025-06-15 09:32:12,998 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:32:12,998 - WARNING - No data returned from SQL query
2025-06-15 09:32:12,999 - INFO - Final prompt created with unique_id_with_template: uid_18ee18c4798645c7a250d51d4d18143c
2025-06-15 09:32:13,356 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:33:19,363 - INFO - Client disconnected from WebSocket
2025-06-15 09:36:04,510 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:36:04,510 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:36:04,512 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:36:04,515 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:36:04,516 - INFO - Processing query for user_id 1: Which projects are past their end date but not marked complete?
2025-06-15 09:36:04,516 - INFO - Generated unique_id_with_template: uid_ac3ef24e71b84ff288dc879987d6ab7c
2025-06-15 09:36:04,937 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:04,967 - INFO - Intent classification: sql
2025-06-15 09:36:04,992 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:36:05,551 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:06,477 - INFO - Generated SQL Query for user_id 1:
SELECT projects.id,
       projects.name,
       projects.end_date,
       projects.state
FROM projects
LEFT JOIN tasks ON projects.id = tasks.project_id
WHERE projects.owner_id = 1
  AND projects.end_date < CURRENT_DATE
  AND projects.state != 'Done';
2025-06-15 09:36:06,479 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:36:06,480 - INFO - Sample data: {'id': 2, 'name': 'Backend Dev', 'end_date': '2025-05-30 00:00:00', 'state': 'started'}
2025-06-15 09:36:06,480 - INFO - Final prompt created with unique_id_with_template: uid_ac3ef24e71b84ff288dc879987d6ab7c
2025-06-15 09:36:06,905 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:40,827 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:36:40,827 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:36:40,829 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:36:40,832 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:36:40,833 - INFO - Processing query for user_id 1: How many tasks have no status assigned?
2025-06-15 09:36:40,833 - INFO - Generated unique_id_with_template: uid_cf5b6ffe4bf74fe9a4d511c279314fcb
2025-06-15 09:36:41,222 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:41,245 - INFO - Intent classification: sql
2025-06-15 09:36:41,258 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:36:41,795 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:42,002 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS tasks_without_status
FROM tasks
WHERE status IS NULL
  AND owner_id = 1
2025-06-15 09:36:42,003 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:36:42,003 - INFO - Sample data: {'tasks_without_status': 0}
2025-06-15 09:36:42,004 - INFO - Final prompt created with unique_id_with_template: uid_cf5b6ffe4bf74fe9a4d511c279314fcb
2025-06-15 09:36:42,396 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:54,802 - INFO - chat_id_enc f8709189-87d4-41f5-a5df-90e5d385e2b2
2025-06-15 09:36:54,802 - INFO - Executing chat history query for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:36:54,803 - INFO - Saving message to DB for chat_id f8709189-87d4-41f5-a5df-90e5d385e2b2, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:36:54,807 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:36:54,807 - INFO - Processing query for user_id 1: Which labels are used most across high-priority tasks?
2025-06-15 09:36:54,807 - INFO - Generated unique_id_with_template: uid_728eb7130aa9453d8db2073bb10ffb52
2025-06-15 09:36:55,256 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:55,316 - INFO - Intent classification: sql
2025-06-15 09:36:55,326 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:36:55,734 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:36:56,407 - INFO - Generated SQL Query for user_id 1:
SELECT labels,
       COUNT(*) AS label_count
FROM tasks
WHERE priority =
    (SELECT MAX(priority)
     FROM tasks
     WHERE owner_id = 1)
  AND owner_id = 1
GROUP BY labels
ORDER BY label_count DESC
2025-06-15 09:36:56,409 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:36:56,410 - INFO - Sample data: {'labels': '[]', 'label_count': 1}
2025-06-15 09:36:56,410 - INFO - Final prompt created with unique_id_with_template: uid_728eb7130aa9453d8db2073bb10ffb52
2025-06-15 09:36:57,181 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:46:29,129 - INFO - Client disconnected from WebSocket
2025-06-15 09:47:04,792 - INFO - Client disconnected from WebSocket
2025-06-15 09:47:23,605 - INFO - chat_id_enc 
2025-06-15 09:47:24,021 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:24,616 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:24,806 - INFO - Created new chat with ID 2 and UUID 3ad09af8-451e-40e4-90f2-52d2746bceaf for user 1
2025-06-15 09:47:24,806 - INFO - 3ad09af8-451e-40e4-90f2-52d2746bceaf
2025-06-15 09:47:24,806 - INFO - Executing chat history query for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:47:24,808 - INFO - Saving message to DB for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:47:24,810 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:47:24,811 - INFO - Processing query for user_id 1: Which project has the tightest deadline vs. workload estimate?
2025-06-15 09:47:24,811 - INFO - Generated unique_id_with_template: uid_8902e17116f240d49ab38805340b45dc
2025-06-15 09:47:26,407 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:26,468 - INFO - Intent classification: sql
2025-06-15 09:47:26,479 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:47:26,970 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:27,689 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       t.title AS task_title,
       t.due_date,
       t.estimate
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
AND p.owner_id = 1
WHERE t.owner_id = 1
ORDER BY t.due_date ASC,
         t.estimate DESC
2025-06-15 09:47:27,691 - INFO - Raw DB data retrieved: 49 rows
2025-06-15 09:47:27,691 - INFO - Sample data: {'project_name': None, 'task_title': 'Research similar platforms', 'due_date': None, 'estimate': None}
2025-06-15 09:47:27,692 - INFO - Final prompt created with unique_id_with_template: uid_8902e17116f240d49ab38805340b45dc
2025-06-15 09:47:28,276 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:45,155 - INFO - chat_id_enc 3ad09af8-451e-40e4-90f2-52d2746bceaf
2025-06-15 09:47:45,155 - INFO - Executing chat history query for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:47:45,156 - INFO - Saving message to DB for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:47:45,160 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:47:45,161 - INFO - Processing query for user_id 1: Which platform has the most deleted or cancelled tasks?
2025-06-15 09:47:45,161 - INFO - Generated unique_id_with_template: uid_6a0a6d7c33a74f3caf94255223fcb3d5
2025-06-15 09:47:45,550 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:45,570 - INFO - Intent classification: sql
2025-06-15 09:47:45,578 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:47:45,887 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:47:46,257 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE,
       COUNT(*) AS deleted_task_count
FROM tasks
WHERE is_deleted = 1
  AND owner_id = 1
GROUP BY SOURCE
ORDER BY deleted_task_count DESC
2025-06-15 09:47:46,258 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:47:46,258 - WARNING - No data returned from SQL query
2025-06-15 09:47:46,259 - INFO - Final prompt created with unique_id_with_template: uid_6a0a6d7c33a74f3caf94255223fcb3d5
2025-06-15 09:47:46,568 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:15,231 - INFO - chat_id_enc 3ad09af8-451e-40e4-90f2-52d2746bceaf
2025-06-15 09:49:15,231 - INFO - Executing chat history query for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:49:15,233 - INFO - Saving message to DB for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:49:15,236 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:49:15,237 - INFO - Processing query for user_id 1: again sorry i didnt catch last response
2025-06-15 09:49:15,238 - INFO - Generated unique_id_with_template: uid_ca1c1852f1314b0bba8aae37abcfeff8
2025-06-15 09:49:15,746 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:15,785 - INFO - Intent classification: chat
2025-06-15 09:49:15,785 - INFO - Final prompt created with unique_id_with_template: uid_ca1c1852f1314b0bba8aae37abcfeff8
2025-06-15 09:49:16,136 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:26,517 - INFO - chat_id_enc 3ad09af8-451e-40e4-90f2-52d2746bceaf
2025-06-15 09:49:26,517 - INFO - Executing chat history query for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:49:26,518 - INFO - Saving message to DB for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:49:26,521 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:49:26,521 - INFO - Processing query for user_id 1: no no repeat the response
2025-06-15 09:49:26,522 - INFO - Generated unique_id_with_template: uid_a982d6a384e746d7ad5c8cc661ca1cd2
2025-06-15 09:49:26,905 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:26,929 - INFO - Intent classification: chat
2025-06-15 09:49:26,929 - INFO - Final prompt created with unique_id_with_template: uid_a982d6a384e746d7ad5c8cc661ca1cd2
2025-06-15 09:49:27,321 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:46,855 - INFO - chat_id_enc 3ad09af8-451e-40e4-90f2-52d2746bceaf
2025-06-15 09:49:46,855 - INFO - Executing chat history query for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:49:46,856 - INFO - Saving message to DB for chat_id 3ad09af8-451e-40e4-90f2-52d2746bceaf, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:49:46,860 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:49:46,861 - INFO - Processing query for user_id 1: again
2025-06-15 09:49:46,861 - INFO - Generated unique_id_with_template: uid_8242c8c18d3a428da872852b0a464637
2025-06-15 09:49:47,589 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:49:47,625 - INFO - Intent classification: chat
2025-06-15 09:49:47,625 - INFO - Final prompt created with unique_id_with_template: uid_8242c8c18d3a428da872852b0a464637
2025-06-15 09:49:48,017 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:05,885 - INFO - chat_id_enc 
2025-06-15 09:50:06,282 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:06,689 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:06,908 - INFO - Created new chat with ID 3 and UUID 9789a480-3684-42c3-9c97-3dabd25b8bfe for user 1
2025-06-15 09:50:06,908 - INFO - 9789a480-3684-42c3-9c97-3dabd25b8bfe
2025-06-15 09:50:06,909 - INFO - Executing chat history query for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:50:06,910 - INFO - Saving message to DB for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:50:06,913 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:50:06,914 - INFO - Processing query for user_id 1: Which project has the highest task reassignment rate?
2025-06-15 09:50:06,914 - INFO - Generated unique_id_with_template: uid_edc5359ce45f46549726bc784defbfb5
2025-06-15 09:50:07,930 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:07,953 - INFO - Intent classification: sql
2025-06-15 09:50:07,962 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:50:08,284 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:09,141 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS reassignment_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
AND p.owner_id = 1
WHERE t.owner_id = 1
  AND t.status = 'In Progress'
GROUP BY p.name
ORDER BY reassignment_count DESC
LIMIT 1
2025-06-15 09:50:09,143 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:50:09,143 - INFO - Sample data: {'project_name': None, 'reassignment_count': 15}
2025-06-15 09:50:09,144 - INFO - Final prompt created with unique_id_with_template: uid_edc5359ce45f46549726bc784defbfb5
2025-06-15 09:50:09,461 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:25,621 - INFO - chat_id_enc 9789a480-3684-42c3-9c97-3dabd25b8bfe
2025-06-15 09:50:25,622 - INFO - Executing chat history query for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:50:25,623 - INFO - Saving message to DB for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:50:25,627 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:50:25,628 - INFO - Processing query for user_id 1: How many tasks per project are marked high priority?
2025-06-15 09:50:25,628 - INFO - Generated unique_id_with_template: uid_7b6d450bfd634259b0357506535fe7a2
2025-06-15 09:50:26,059 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:26,101 - INFO - Intent classification: sql
2025-06-15 09:50:26,109 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:50:26,418 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:50:27,313 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS high_priority_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.platform_id
AND t.owner_id = p.owner_id
WHERE t.priority = 1
  AND t.owner_id = 1
GROUP BY p.name
2025-06-15 09:50:27,315 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:50:27,315 - INFO - Sample data: {'project_name': None, 'high_priority_task_count': 2}
2025-06-15 09:50:27,316 - INFO - Final prompt created with unique_id_with_template: uid_7b6d450bfd634259b0357506535fe7a2
2025-06-15 09:50:27,633 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:51:31,004 - INFO - Client disconnected from WebSocket
2025-06-15 09:52:03,668 - INFO - chat_id_enc 9789a480-3684-42c3-9c97-3dabd25b8bfe
2025-06-15 09:52:03,668 - INFO - Executing chat history query for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:52:03,669 - INFO - Saving message to DB for chat_id 9789a480-3684-42c3-9c97-3dabd25b8bfe, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:52:03,673 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:52:03,674 - INFO - Processing query for user_id 1: Which platform has the most overdue tasks?
2025-06-15 09:52:03,674 - INFO - Generated unique_id_with_template: uid_6da491d8face44fb9018057ab79694e7
2025-06-15 09:52:04,701 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:04,725 - INFO - Intent classification: sql
2025-06-15 09:52:04,734 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:52:05,250 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:05,868 - INFO - Generated SQL Query for user_id 1:
SELECT t.source,
       COUNT(*) AS overdue_task_count
FROM tasks t
WHERE t.due_date < CURRENT_DATE
  AND t.owner_id = 1
GROUP BY t.source
ORDER BY overdue_task_count DESC
LIMIT 1
2025-06-15 09:52:05,870 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:52:05,870 - INFO - Sample data: {'source': 'linear', 'overdue_task_count': 12}
2025-06-15 09:52:05,871 - INFO - Final prompt created with unique_id_with_template: uid_6da491d8face44fb9018057ab79694e7
2025-06-15 09:52:06,214 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:43,616 - INFO - chat_id_enc 
2025-06-15 09:52:43,931 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:44,436 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:44,621 - INFO - Created new chat with ID 4 and UUID 0c5beb7a-cd84-46e7-acbf-221634936c25 for user 1
2025-06-15 09:52:44,622 - INFO - 0c5beb7a-cd84-46e7-acbf-221634936c25
2025-06-15 09:52:44,623 - INFO - Executing chat history query for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:52:44,624 - INFO - Saving message to DB for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:52:44,627 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:52:44,628 - INFO - Processing query for user_id 1: How many tasks are due in the next 7 days?
2025-06-15 09:52:44,629 - INFO - Generated unique_id_with_template: uid_6d2a697dca534e3c943a8662de085c1b
2025-06-15 09:52:45,010 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:45,035 - INFO - Intent classification: sql
2025-06-15 09:52:45,045 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:52:45,336 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:45,668 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS due_tasks_count
FROM tasks
WHERE due_date BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 7 DAY)
  AND owner_id = 1
2025-06-15 09:52:45,669 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:52:45,669 - INFO - Sample data: {'due_tasks_count': 0}
2025-06-15 09:52:45,669 - INFO - Final prompt created with unique_id_with_template: uid_6d2a697dca534e3c943a8662de085c1b
2025-06-15 09:52:46,075 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:57,534 - INFO - chat_id_enc 0c5beb7a-cd84-46e7-acbf-221634936c25
2025-06-15 09:52:57,535 - INFO - Executing chat history query for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:52:57,536 - INFO - Saving message to DB for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:52:57,539 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:52:57,539 - INFO - Processing query for user_id 1: Which platform has the most overdue tasks?
2025-06-15 09:52:57,539 - INFO - Generated unique_id_with_template: uid_b7e1524af7244e2e9ac86c91f3a911ff
2025-06-15 09:52:57,910 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:57,934 - INFO - Intent classification: sql
2025-06-15 09:52:57,943 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:52:58,334 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:52:59,158 - INFO - Generated SQL Query for user_id 1:
SELECT t.source,
       COUNT(*) AS overdue_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.platform_id
WHERE t.due_date < CURDATE()
  AND t.owner_id = 1
  AND t.status != 'Done'
GROUP BY t.source
ORDER BY overdue_task_count DESC
LIMIT 1
2025-06-15 09:52:59,160 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:52:59,160 - INFO - Sample data: {'source': 'linear', 'overdue_task_count': 12}
2025-06-15 09:52:59,161 - INFO - Final prompt created with unique_id_with_template: uid_b7e1524af7244e2e9ac86c91f3a911ff
2025-06-15 09:52:59,469 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:12,975 - INFO - chat_id_enc 0c5beb7a-cd84-46e7-acbf-221634936c25
2025-06-15 09:53:12,975 - INFO - Executing chat history query for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:53:12,976 - INFO - Saving message to DB for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:53:12,979 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:53:12,980 - INFO - Processing query for user_id 1: Which projects have the most overdue tasks?
2025-06-15 09:53:12,980 - INFO - Generated unique_id_with_template: uid_cdf0163cfeb742ffbfcb97c8432079ab
2025-06-15 09:53:13,418 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:13,474 - INFO - Intent classification: sql
2025-06-15 09:53:13,485 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:53:14,171 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:14,789 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS overdue_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.due_date < CURDATE()
  AND t.owner_id = 1
GROUP BY p.name
ORDER BY overdue_task_count DESC
2025-06-15 09:53:14,792 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:53:14,792 - INFO - Sample data: {'project_name': None, 'overdue_task_count': 12}
2025-06-15 09:53:14,793 - INFO - Final prompt created with unique_id_with_template: uid_cdf0163cfeb742ffbfcb97c8432079ab
2025-06-15 09:53:15,136 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:30,422 - INFO - chat_id_enc 0c5beb7a-cd84-46e7-acbf-221634936c25
2025-06-15 09:53:30,422 - INFO - Executing chat history query for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:53:30,424 - INFO - Saving message to DB for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:53:30,430 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:53:30,431 - INFO - Processing query for user_id 1: Which source has the most completed projects?
2025-06-15 09:53:30,431 - INFO - Generated unique_id_with_template: uid_b8b541c437584ecfa1013198316ac23a
2025-06-15 09:53:30,789 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:30,811 - INFO - Intent classification: sql
2025-06-15 09:53:30,822 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:53:31,199 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:53:31,768 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE,
       COUNT(*) AS completed_project_count
FROM projects
WHERE state = 'Done'
  AND owner_id = 1
GROUP BY SOURCE
ORDER BY completed_project_count DESC
2025-06-15 09:53:31,769 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:53:31,769 - WARNING - No data returned from SQL query
2025-06-15 09:53:31,770 - INFO - Final prompt created with unique_id_with_template: uid_b8b541c437584ecfa1013198316ac23a
2025-06-15 09:53:32,175 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:54:06,199 - INFO - chat_id_enc 0c5beb7a-cd84-46e7-acbf-221634936c25
2025-06-15 09:54:06,199 - INFO - Executing chat history query for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:54:06,201 - INFO - Saving message to DB for chat_id 0c5beb7a-cd84-46e7-acbf-221634936c25, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:54:06,205 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:54:06,205 - INFO - Processing query for user_id 1: repeat this same rsposnse again
2025-06-15 09:54:06,205 - INFO - Generated unique_id_with_template: uid_2ce09febfc8245b5a3e7a998997cd33e
2025-06-15 09:54:06,598 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:54:06,619 - INFO - Intent classification: chat
2025-06-15 09:54:06,619 - INFO - Final prompt created with unique_id_with_template: uid_2ce09febfc8245b5a3e7a998997cd33e
2025-06-15 09:54:06,994 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:18,425 - INFO - Client disconnected from WebSocket
2025-06-15 09:55:48,460 - INFO - chat_id_enc 
2025-06-15 09:55:48,804 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:49,250 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:49,467 - INFO - Created new chat with ID 5 and UUID 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c for user 1
2025-06-15 09:55:49,468 - INFO - 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c
2025-06-15 09:55:49,469 - INFO - Executing chat history query for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:55:49,470 - INFO - Saving message to DB for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:55:49,472 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:55:49,473 - INFO - Processing query for user_id 1: Which project has the most deleted tasks?
2025-06-15 09:55:49,473 - INFO - Generated unique_id_with_template: uid_b5e5419def934b0187157df1dcb41388
2025-06-15 09:55:49,881 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:49,913 - INFO - Intent classification: sql
2025-06-15 09:55:49,928 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:55:50,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:51,045 - INFO - Generated SQL Query for user_id 1:
SELECT p.name,
       COUNT(t.id) AS deleted_tasks_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.is_deleted = 1
  AND t.owner_id = 1
GROUP BY p.name
ORDER BY deleted_tasks_count DESC
LIMIT 1
2025-06-15 09:55:51,046 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:55:51,047 - WARNING - No data returned from SQL query
2025-06-15 09:55:51,047 - INFO - Final prompt created with unique_id_with_template: uid_b5e5419def934b0187157df1dcb41388
2025-06-15 09:55:51,376 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:58,342 - INFO - chat_id_enc 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c
2025-06-15 09:55:58,343 - INFO - Executing chat history query for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:55:58,343 - INFO - Saving message to DB for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:55:58,347 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:55:58,348 - INFO - Processing query for user_id 1: Which user is assigned to the most overdue tasks?
2025-06-15 09:55:58,348 - INFO - Generated unique_id_with_template: uid_1e43b2f939fb4b57a8d3d5738a48a587
2025-06-15 09:55:58,720 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:55:58,755 - INFO - Intent classification: sql
2025-06-15 09:55:58,764 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:55:59,066 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:00,085 - INFO - Generated SQL Query for user_id 1:
SELECT pu.name,
       COUNT(t.id) AS overdue_task_count
FROM tasks t
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
AND t.owner_id = pu.owner_id
WHERE t.owner_id = 1
  AND t.due_date < CURRENT_DATE
  AND t.status != 'Done'
GROUP BY pu.name
ORDER BY overdue_task_count DESC
LIMIT 1
2025-06-15 09:56:00,087 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:56:00,087 - INFO - Sample data: {'name': 'allphonesblog ng', 'overdue_task_count': 11}
2025-06-15 09:56:00,088 - INFO - Final prompt created with unique_id_with_template: uid_1e43b2f939fb4b57a8d3d5738a48a587
2025-06-15 09:56:00,444 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:15,951 - INFO - chat_id_enc 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c
2025-06-15 09:56:15,951 - INFO - Executing chat history query for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:56:15,953 - INFO - Saving message to DB for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:56:15,957 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:56:15,958 - INFO - Processing query for user_id 1: Which project has the most deleted tasks?
2025-06-15 09:56:15,958 - INFO - Generated unique_id_with_template: uid_1b9bbcdef695446aa3f083f2a54a604c
2025-06-15 09:56:16,355 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:16,388 - INFO - Intent classification: sql
2025-06-15 09:56:16,398 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:56:16,712 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:17,437 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS deleted_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.is_deleted = 1
  AND t.owner_id = 1
GROUP BY p.name
ORDER BY deleted_task_count DESC
LIMIT 1
2025-06-15 09:56:17,438 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 09:56:17,439 - WARNING - No data returned from SQL query
2025-06-15 09:56:17,439 - INFO - Final prompt created with unique_id_with_template: uid_1b9bbcdef695446aa3f083f2a54a604c
2025-06-15 09:56:17,796 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:23,961 - INFO - chat_id_enc 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c
2025-06-15 09:56:23,962 - INFO - Executing chat history query for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 09:56:23,963 - INFO - Saving message to DB for chat_id 1c5f4fe1-4a43-4270-a0cf-3afa2f47db2c, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 09:56:23,966 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 09:56:23,966 - INFO - Processing query for user_id 1: What’s the average task estimate per platform?
2025-06-15 09:56:23,966 - INFO - Generated unique_id_with_template: uid_ea90eab499b749929ee81bc19d45f2a5
2025-06-15 09:56:24,386 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:24,433 - INFO - Intent classification: sql
2025-06-15 09:56:24,440 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 09:56:24,769 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 09:56:25,195 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE AS platform,
                 AVG(estimate) AS average_estimate
FROM tasks
WHERE owner_id = 1
GROUP BY SOURCE
2025-06-15 09:56:25,197 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 09:56:25,197 - INFO - Sample data: {'platform': 'linear', 'average_estimate': -22.99314163128535}
2025-06-15 09:56:25,198 - INFO - Final prompt created with unique_id_with_template: uid_ea90eab499b749929ee81bc19d45f2a5
2025-06-15 09:56:25,607 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:12:55,833 - INFO - Client disconnected from WebSocket
2025-06-15 10:13:04,908 - INFO - chat_id_enc 
2025-06-15 10:13:05,333 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:13:06,675 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:13:06,772 - INFO - Created new chat with ID 6 and UUID 70217305-d8fd-4608-8ca7-672166ea6781 for user 1
2025-06-15 10:13:06,772 - INFO - 70217305-d8fd-4608-8ca7-672166ea6781
2025-06-15 10:13:06,773 - INFO - Executing chat history query for chat_id 70217305-d8fd-4608-8ca7-672166ea6781:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:13:06,773 - INFO - Saving message to DB for chat_id 70217305-d8fd-4608-8ca7-672166ea6781, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:13:06,776 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:13:06,777 - INFO - Processing query for user_id 1: Which project has the highest number of completed tasks?
2025-06-15 10:13:06,777 - INFO - Generated unique_id_with_template: uid_0fd0eaebc73244d39b37b447d90acfeb
2025-06-15 10:13:07,235 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:13:07,266 - INFO - Intent classification: sql
2025-06-15 10:13:07,278 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:13:07,746 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:13:10,550 - INFO - Generated SQL Query for user_id 1:
SELECT p.name,
       COUNT(t.id) AS completed_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.status = 'Done'
  AND t.owner_id = 1
GROUP BY p.name
ORDER BY completed_task_count DESC
LIMIT 1
2025-06-15 10:13:10,552 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 10:13:10,552 - INFO - Sample data: {'name': None, 'completed_task_count': 15}
2025-06-15 10:13:10,553 - INFO - Final prompt created with unique_id_with_template: uid_0fd0eaebc73244d39b37b447d90acfeb
2025-06-15 10:13:11,045 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:28,859 - INFO - Client disconnected from WebSocket
2025-06-15 10:14:41,906 - INFO - chat_id_enc 
2025-06-15 10:14:42,552 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:43,138 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:43,282 - INFO - Created new chat with ID 7 and UUID f9925851-649f-4310-b23b-fd7fa1b66885 for user 1
2025-06-15 10:14:43,282 - INFO - f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:14:43,283 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:14:43,284 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:14:43,292 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:14:43,293 - INFO - Processing query for user_id 1: Which labels are used most across high-priority tasks?
2025-06-15 10:14:43,293 - INFO - Generated unique_id_with_template: uid_4938e847a02a4431ad49197c01e54432
2025-06-15 10:14:43,843 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:43,871 - INFO - Intent classification: sql
2025-06-15 10:14:43,887 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:14:44,352 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:45,092 - INFO - Generated SQL Query for user_id 1:
SELECT t.labels,
       COUNT(*) AS label_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.priority = 1
  AND t.owner_id = 1
GROUP BY t.labels
ORDER BY label_count DESC
2025-06-15 10:14:45,094 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 10:14:45,094 - INFO - Sample data: {'labels': '[]', 'label_count': 2}
2025-06-15 10:14:45,094 - INFO - Final prompt created with unique_id_with_template: uid_4938e847a02a4431ad49197c01e54432
2025-06-15 10:14:45,435 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:53,503 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:14:53,503 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:14:53,505 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:14:53,509 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:14:53,510 - INFO - Processing query for user_id 1: Which projects are past their end date but not marked complete?
2025-06-15 10:14:53,510 - INFO - Generated unique_id_with_template: uid_cb544560608f4dc0844dd1d9baa87c53
2025-06-15 10:14:58,301 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:14:58,335 - INFO - Intent classification: sql
2025-06-15 10:14:58,343 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:14:58,656 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:15:00,104 - INFO - Generated SQL Query for user_id 1:
SELECT projects.name AS project_name,
       projects.end_date,
       projects.state
FROM projects
LEFT JOIN tasks ON projects.id = tasks.project_id
WHERE projects.owner_id = 1
  AND projects.end_date IS NOT NULL
  AND projects.end_date < NOW()
  AND projects.state != 'Done'
2025-06-15 10:15:00,106 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 10:15:00,106 - INFO - Sample data: {'project_name': 'Backend Dev', 'end_date': '2025-05-30 00:00:00', 'state': 'started'}
2025-06-15 10:15:00,107 - INFO - Final prompt created with unique_id_with_template: uid_cb544560608f4dc0844dd1d9baa87c53
2025-06-15 10:15:00,473 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:15:31,527 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:15:31,527 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:15:31,528 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:15:31,536 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:15:31,537 - INFO - Processing query for user_id 1: Which projects haven’t been updated since creation?
2025-06-15 10:15:31,537 - INFO - Generated unique_id_with_template: uid_4313e8b6a21d4f50b9d4ff0a0c765e79
2025-06-15 10:15:32,617 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:15:32,664 - INFO - Intent classification: sql
2025-06-15 10:15:32,674 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:15:33,028 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:15:33,513 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       p.created_at
FROM projects p
WHERE p.owner_id = 1
  AND p.created_at = p.updated_at
2025-06-15 10:15:33,514 - INFO - Raw DB data retrieved: 3 rows
2025-06-15 10:15:33,515 - INFO - Sample data: {'project_name': 'Review', 'created_at': datetime.datetime(2025, 3, 20, 9, 33, 45)}
2025-06-15 10:15:33,515 - INFO - Final prompt created with unique_id_with_template: uid_4313e8b6a21d4f50b9d4ff0a0c765e79
2025-06-15 10:15:33,867 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:12,385 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:16:12,385 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:16:12,386 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:16:12,391 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:16:12,392 - INFO - Processing query for user_id 1: How does task volume differ between Linear, Trello, and Jira?
2025-06-15 10:16:12,392 - INFO - Generated unique_id_with_template: uid_a5d87e552c874d888178b01e4a95cb6d
2025-06-15 10:16:12,857 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:12,860 - INFO - Intent classification: sql
2025-06-15 10:16:12,868 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:16:13,606 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:13,930 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE,
       COUNT(id) AS task_volume
FROM tasks
WHERE owner_id = 1
GROUP BY SOURCE
2025-06-15 10:16:13,932 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 10:16:13,932 - INFO - Sample data: {'SOURCE': 'linear', 'task_volume': 49}
2025-06-15 10:16:13,932 - INFO - Final prompt created with unique_id_with_template: uid_a5d87e552c874d888178b01e4a95cb6d
2025-06-15 10:16:14,348 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:30,892 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:16:30,892 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:16:30,894 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:16:30,897 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:16:30,898 - INFO - Processing query for user_id 1: Which project has the highest task reassignment rate?
2025-06-15 10:16:30,898 - INFO - Generated unique_id_with_template: uid_2e868400eec440d5b79dfaa64d2de548
2025-06-15 10:16:31,277 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:31,321 - INFO - Intent classification: sql
2025-06-15 10:16:31,329 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci ENGINE=InnoDB\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 10:16:31,862 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:16:32,713 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS reassignment_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.owner_id = 1
  AND t.user_id IS NOT NULL
GROUP BY p.name
ORDER BY reassignment_count DESC
LIMIT 1
2025-06-15 10:16:32,714 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 10:16:32,714 - INFO - Sample data: {'project_name': None, 'reassignment_count': 40}
2025-06-15 10:16:32,715 - INFO - Final prompt created with unique_id_with_template: uid_2e868400eec440d5b79dfaa64d2de548
2025-06-15 10:16:33,553 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:23:11,798 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:23:11,798 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:23:11,800 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:23:11,805 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:23:11,806 - INFO - Processing query for user_id 1: give this response exactly as same 
2025-06-15 10:23:11,806 - INFO - Generated unique_id_with_template: uid_15f8fd0403604e00b10b30716d649190
2025-06-15 10:23:12,931 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:23:12,963 - INFO - Intent classification: chat
2025-06-15 10:23:12,963 - INFO - Final prompt created with unique_id_with_template: uid_15f8fd0403604e00b10b30716d649190
2025-06-15 10:23:13,436 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:29:04,161 - INFO - Client disconnected from WebSocket
2025-06-15 10:29:35,741 - INFO - Client disconnected from WebSocket
2025-06-15 10:30:28,464 - INFO - Client disconnected from WebSocket
2025-06-15 10:32:23,644 - INFO - Client disconnected from WebSocket
2025-06-15 10:34:12,694 - INFO - Client disconnected from WebSocket
2025-06-15 10:34:41,453 - INFO - Client disconnected from WebSocket
2025-06-15 10:34:49,276 - INFO - Client disconnected from WebSocket
2025-06-15 10:35:07,343 - INFO - Client disconnected from WebSocket
2025-06-15 10:36:05,375 - INFO - Client disconnected from WebSocket
2025-06-15 10:40:32,032 - INFO - Client disconnected from WebSocket
2025-06-15 10:47:54,164 - INFO - Client disconnected from WebSocket
2025-06-15 10:48:17,464 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 10:48:17,464 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 10:48:17,465 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 10:48:17,469 - INFO - Generated unique_id_with_template: uid_13b00ddf0a984a20b909bc7fb45f6ec4_af9df7fde29c797d_1749984497469
2025-06-15 10:48:17,469 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 10:48:17,470 - INFO - Processing query for user_id 1: again
2025-06-15 10:48:17,470 - INFO - Generated unique_id_with_template: uid_13b00ddf0a984a20b909bc7fb45f6ec4_af9df7fde29c797d_1749984497469
2025-06-15 10:48:18,675 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 10:48:18,706 - INFO - Intent classification: chat
2025-06-15 10:48:18,706 - INFO - Final prompt created with unique_id_with_template: uid_13b00ddf0a984a20b909bc7fb45f6ec4_af9df7fde29c797d_1749984497469
2025-06-15 10:48:19,349 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:00:05,005 - INFO - Client disconnected from WebSocket
2025-06-15 11:02:12,404 - INFO - Client disconnected from WebSocket
2025-06-15 11:06:00,263 - INFO - Client disconnected from WebSocket
2025-06-15 11:06:31,177 - INFO - Client disconnected from WebSocket
2025-06-15 11:06:46,881 - INFO - Client disconnected from WebSocket
2025-06-15 11:06:53,130 - INFO - Client disconnected from WebSocket
2025-06-15 11:06:57,947 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:06:57,947 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:06:57,949 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:06:57,954 - INFO - Generated unique_id_with_template: uid_5ebf806fd30d4522955ad67e20258f5e_efc16f83f689f42b_1749985617954
2025-06-15 11:06:57,954 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:06:57,955 - INFO - Processing query for user_id 1: Which projects haven’t been updated since creation?
2025-06-15 11:06:57,955 - INFO - Generated unique_id_with_template: uid_5ebf806fd30d4522955ad67e20258f5e_efc16f83f689f42b_1749985617954
2025-06-15 11:06:58,494 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:06:58,525 - INFO - Intent classification: sql
2025-06-15 11:06:58,547 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:06:59,083 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:06:59,944 - INFO - Generated SQL Query for user_id 1:
SELECT projects.name
FROM projects
LEFT JOIN tasks ON projects.id = tasks.project_id
WHERE projects.owner_id = 1
  AND projects.created_at = projects.updated_at;
2025-06-15 11:06:59,946 - INFO - Raw DB data retrieved: 3 rows
2025-06-15 11:06:59,946 - INFO - Sample data: {'name': 'Review'}
2025-06-15 11:06:59,946 - INFO - Final prompt created with unique_id_with_template: uid_5ebf806fd30d4522955ad67e20258f5e_efc16f83f689f42b_1749985617954
2025-06-15 11:07:01,205 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:07:26,894 - INFO - Client disconnected from WebSocket
2025-06-15 11:09:14,365 - INFO - Client disconnected from WebSocket
2025-06-15 11:10:17,082 - INFO - Client disconnected from WebSocket
2025-06-15 11:11:02,456 - INFO - Client disconnected from WebSocket
2025-06-15 11:11:38,476 - INFO - Client disconnected from WebSocket
2025-06-15 11:12:04,249 - INFO - Client disconnected from WebSocket
2025-06-15 11:12:34,072 - INFO - Client disconnected from WebSocket
2025-06-15 11:13:23,567 - INFO - Client disconnected from WebSocket
2025-06-15 11:14:47,760 - INFO - Client disconnected from WebSocket
2025-06-15 11:15:29,342 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:15:29,342 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:15:29,345 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:15:29,349 - INFO - Generated unique_id_with_template: uid_1828f5189bb046c394998e0a52455b94_6fea9f32ba4cc9df_1749986129349
2025-06-15 11:15:29,349 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:15:29,350 - INFO - Processing query for user_id 1: uhmm info about ayo pls
2025-06-15 11:15:29,351 - INFO - Generated unique_id_with_template: uid_1828f5189bb046c394998e0a52455b94_6fea9f32ba4cc9df_1749986129349
2025-06-15 11:15:30,414 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:15:30,441 - INFO - Intent classification: sql
2025-06-15 11:15:30,453 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:15:30,860 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:15:31,406 - INFO - Generated SQL Query for user_id 1:
SELECT id,
       name,
       email,
       user_id,
       platform_id,
       full_name,
       SOURCE,
       created_at,
       updated_at
FROM platform_users
WHERE owner_id = 1
  AND name LIKE '%ayo%'
2025-06-15 11:15:31,407 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 11:15:31,408 - INFO - Sample data: {'id': 3, 'name': 'dev.ayomide@gmail.com', 'email': 'dev.ayomide@gmail.com', 'user_id': '1d66d358-c981-4563-917f-8e8b35b497e6', 'platform_id': 1, 'full_name': 'dev.ayomide@gmail.com', 'SOURCE': 'linear', 'created_at': datetime.datetime(2025, 3, 18, 9, 45, 42), 'updated_at': datetime.datetime(2025, 3, 18, 9, 45, 42)}
2025-06-15 11:15:31,408 - INFO - Final prompt created with unique_id_with_template: uid_1828f5189bb046c394998e0a52455b94_6fea9f32ba4cc9df_1749986129349
2025-06-15 11:15:31,820 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:15:42,160 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:15:42,161 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:15:42,162 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:15:42,166 - INFO - Generated unique_id_with_template: uid_003d8fc1697c469f8e36aa59489d665a_623c6e229873b7bf_1749986142166
2025-06-15 11:15:42,166 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:15:42,167 - INFO - Processing query for user_id 1: How many tasks were synced in the last 24 hours?
2025-06-15 11:15:42,167 - INFO - Generated unique_id_with_template: uid_003d8fc1697c469f8e36aa59489d665a_623c6e229873b7bf_1749986142166
2025-06-15 11:15:42,551 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:15:42,582 - INFO - Intent classification: sql
2025-06-15 11:15:42,593 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:15:43,130 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:15:43,532 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS tasks_synced_last_24_hours
FROM tasks
WHERE last_synced_at >= NOW() - INTERVAL 1 DAY
  AND owner_id = 1
2025-06-15 11:15:43,533 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 11:15:43,533 - INFO - Sample data: {'tasks_synced_last_24_hours': 0}
2025-06-15 11:15:43,534 - INFO - Final prompt created with unique_id_with_template: uid_003d8fc1697c469f8e36aa59489d665a_623c6e229873b7bf_1749986142166
2025-06-15 11:15:43,954 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:16:12,951 - INFO - Client disconnected from WebSocket
2025-06-15 11:16:49,149 - INFO - Client disconnected from WebSocket
2025-06-15 11:16:54,483 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:16:54,484 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:16:54,485 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:16:54,489 - INFO - Generated unique_id_with_template: uid_6b0094303b534784b8cf773061b4b28e_0c96b2e35fa06076_1749986214488
2025-06-15 11:16:54,489 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:16:54,490 - INFO - Processing query for user_id 1: more info pls
2025-06-15 11:16:54,490 - INFO - Generated unique_id_with_template: uid_6b0094303b534784b8cf773061b4b28e_0c96b2e35fa06076_1749986214488
2025-06-15 11:16:54,874 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:16:54,898 - INFO - Intent classification: chat
2025-06-15 11:16:54,899 - INFO - Final prompt created with unique_id_with_template: uid_6b0094303b534784b8cf773061b4b28e_0c96b2e35fa06076_1749986214488
2025-06-15 11:16:55,312 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:17:57,799 - INFO - Client disconnected from WebSocket
2025-06-15 11:18:05,687 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:18:05,687 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:18:05,688 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:18:05,692 - INFO - Generated unique_id_with_template: uid_975467dd475d4e2a86295a1101be1c39_92c818b762dd4770_1749986285692
2025-06-15 11:18:05,692 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:18:05,693 - INFO - Processing query for user_id 1: more
2025-06-15 11:18:05,693 - INFO - Generated unique_id_with_template: uid_975467dd475d4e2a86295a1101be1c39_92c818b762dd4770_1749986285692
2025-06-15 11:18:06,110 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:18:06,146 - INFO - Intent classification: chat
2025-06-15 11:18:06,146 - INFO - Final prompt created with unique_id_with_template: uid_975467dd475d4e2a86295a1101be1c39_92c818b762dd4770_1749986285692
2025-06-15 11:18:07,084 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:18:47,327 - INFO - Client disconnected from WebSocket
2025-06-15 11:18:50,534 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:18:50,534 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:18:50,535 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:18:50,540 - INFO - Generated unique_id_with_template: uid_62804cdeecda443d8263e6248f602f05_51e8ef7b0e4a79fd_1749986330539
2025-06-15 11:18:50,540 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:18:50,540 - INFO - Processing query for user_id 1: again pls
2025-06-15 11:18:50,541 - INFO - Generated unique_id_with_template: uid_62804cdeecda443d8263e6248f602f05_51e8ef7b0e4a79fd_1749986330539
2025-06-15 11:18:50,923 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:18:50,951 - INFO - Intent classification: chat
2025-06-15 11:18:50,951 - INFO - Final prompt created with unique_id_with_template: uid_62804cdeecda443d8263e6248f602f05_51e8ef7b0e4a79fd_1749986330539
2025-06-15 11:18:51,925 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:19:13,713 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:19:13,713 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:19:13,714 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:19:13,722 - INFO - Generated unique_id_with_template: uid_6a2568a804c947748dd3f3d6b72dc7a3_23125ea32f7c4ca5_1749986353721
2025-06-15 11:19:13,722 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:19:13,722 - INFO - Processing query for user_id 1: again
2025-06-15 11:19:13,723 - INFO - Generated unique_id_with_template: uid_6a2568a804c947748dd3f3d6b72dc7a3_23125ea32f7c4ca5_1749986353721
2025-06-15 11:19:14,115 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:19:14,161 - INFO - Intent classification: chat
2025-06-15 11:19:14,161 - INFO - Final prompt created with unique_id_with_template: uid_6a2568a804c947748dd3f3d6b72dc7a3_23125ea32f7c4ca5_1749986353721
2025-06-15 11:19:14,678 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:19:31,209 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:19:31,209 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:19:31,211 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:19:31,214 - INFO - Generated unique_id_with_template: uid_4b8d3e36b37643dfbb21c99d83b02514_ea5e79c60e3292e9_1749986371214
2025-06-15 11:19:31,214 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:19:31,215 - INFO - Processing query for user_id 1: give bar chart and another chart
2025-06-15 11:19:31,215 - INFO - Generated unique_id_with_template: uid_4b8d3e36b37643dfbb21c99d83b02514_ea5e79c60e3292e9_1749986371214
2025-06-15 11:19:32,353 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:19:32,423 - INFO - Intent classification: sql
2025-06-15 11:19:32,431 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:19:32,842 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:19:33,596 - INFO - Generated SQL Query for user_id 1:
SELECT DATE(last_synced_at) AS date,
       COUNT(*) AS tasks_synced
FROM tasks
WHERE last_synced_at >= NOW() - INTERVAL 7 DAY
  AND owner_id = 1
GROUP BY DATE(last_synced_at);
2025-06-15 11:19:33,597 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 11:19:33,597 - WARNING - No data returned from SQL query
2025-06-15 11:19:33,597 - INFO - Final prompt created with unique_id_with_template: uid_4b8d3e36b37643dfbb21c99d83b02514_ea5e79c60e3292e9_1749986371214
2025-06-15 11:19:34,141 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:20:43,294 - INFO - Client disconnected from WebSocket
2025-06-15 11:20:48,145 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:20:48,145 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:20:48,146 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:20:48,149 - INFO - Generated unique_id_with_template: uid_fe83f51babe14b42a08a43b50ccb2fd0_bdda599ffe5a3b31_1749986448149
2025-06-15 11:20:48,150 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:20:48,150 - INFO - Processing query for user_id 1: What’s the average priority level of tasks in each project?
2025-06-15 11:20:48,151 - INFO - Generated unique_id_with_template: uid_fe83f51babe14b42a08a43b50ccb2fd0_bdda599ffe5a3b31_1749986448149
2025-06-15 11:20:48,581 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:20:48,611 - INFO - Intent classification: sql
2025-06-15 11:20:48,621 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:20:48,929 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:20:49,658 - INFO - Generated SQL Query for user_id 1:
SELECT projects.name AS project_name,
       AVG(tasks.priority) AS average_priority
FROM tasks
LEFT JOIN projects ON tasks.project_id = projects.platform_id
WHERE tasks.owner_id = 1
GROUP BY projects.name
2025-06-15 11:20:49,661 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 11:20:49,661 - INFO - Sample data: {'project_name': None, 'average_priority': Decimal('1.2449')}
2025-06-15 11:20:49,662 - INFO - Final prompt created with unique_id_with_template: uid_fe83f51babe14b42a08a43b50ccb2fd0_bdda599ffe5a3b31_1749986448149
2025-06-15 11:20:50,101 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:16,942 - INFO - Client disconnected from WebSocket
2025-06-15 11:21:39,592 - INFO - Client disconnected from WebSocket
2025-06-15 11:21:43,010 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:21:43,010 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:21:43,011 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:21:43,014 - INFO - Generated unique_id_with_template: uid_3c5757291c1b49958339cee7af400fb9_f7a9aab098311bfa_1749986503014
2025-06-15 11:21:43,014 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:21:43,015 - INFO - Processing query for user_id 1: How does task volume differ between Linear, Trello, and Jira?
2025-06-15 11:21:43,015 - INFO - Generated unique_id_with_template: uid_3c5757291c1b49958339cee7af400fb9_f7a9aab098311bfa_1749986503014
2025-06-15 11:21:43,405 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:43,435 - INFO - Intent classification: sql
2025-06-15 11:21:43,443 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:21:43,770 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:44,087 - INFO - Generated SQL Query for user_id 1:
SELECT SOURCE,
       COUNT(*) AS task_volume
FROM tasks
WHERE owner_id = 1
GROUP BY SOURCE
2025-06-15 11:21:44,088 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 11:21:44,088 - INFO - Sample data: {'SOURCE': 'linear', 'task_volume': 49}
2025-06-15 11:21:44,089 - INFO - Final prompt created with unique_id_with_template: uid_3c5757291c1b49958339cee7af400fb9_f7a9aab098311bfa_1749986503014
2025-06-15 11:21:44,490 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:52,338 - INFO - chat_id_enc f9925851-649f-4310-b23b-fd7fa1b66885
2025-06-15 11:21:52,338 - INFO - Executing chat history query for chat_id f9925851-649f-4310-b23b-fd7fa1b66885:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:21:52,340 - INFO - Saving message to DB for chat_id f9925851-649f-4310-b23b-fd7fa1b66885, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:21:52,345 - INFO - Generated unique_id_with_template: uid_ec41e32fae00430ab1a34e753c3e7481_6f1a04cc198bd913_1749986512345
2025-06-15 11:21:52,345 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:21:52,346 - INFO - Processing query for user_id 1: What is the distribution of task priorities across all projects?
2025-06-15 11:21:52,346 - INFO - Generated unique_id_with_template: uid_ec41e32fae00430ab1a34e753c3e7481_6f1a04cc198bd913_1749986512345
2025-06-15 11:21:52,708 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:52,732 - INFO - Intent classification: sql
2025-06-15 11:21:52,744 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n2\tlinear\tNone\tlin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_c9784e9522f846b0cb1a593549026da9025b049b63cfe6465e8fcabdab05591d\",\"token_\t2025-06-05 14:51:01\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:21:53,053 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:21:53,775 - INFO - Generated SQL Query for user_id 1:
SELECT t.priority,
       COUNT(t.id) AS task_count,
       p.name AS project_name
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.owner_id = 1
GROUP BY t.priority,
         p.name
ORDER BY p.name,
         t.priority;
2025-06-15 11:21:53,776 - INFO - Raw DB data retrieved: 4 rows
2025-06-15 11:21:53,777 - INFO - Sample data: {'priority': 0, 'task_count': 18, 'project_name': None}
2025-06-15 11:21:53,777 - INFO - Final prompt created with unique_id_with_template: uid_ec41e32fae00430ab1a34e753c3e7481_6f1a04cc198bd913_1749986512345
2025-06-15 11:21:54,201 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:22:20,807 - INFO - Client disconnected from WebSocket
2025-06-15 11:22:24,791 - INFO - Client disconnected from WebSocket
2025-06-15 11:23:07,400 - INFO - Client disconnected from WebSocket
2025-06-15 11:23:14,013 - INFO - Client disconnected from WebSocket
2025-06-15 11:23:38,265 - INFO - chat_id_enc 
2025-06-15 11:23:38,660 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:39,393 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:39,675 - INFO - Created new chat with ID 8 and UUID a4682afb-2dbc-4048-b74c-5ab9e839d38f for user 2
2025-06-15 11:23:39,676 - INFO - a4682afb-2dbc-4048-b74c-5ab9e839d38f
2025-06-15 11:23:39,676 - INFO - Executing chat history query for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:23:39,677 - INFO - Saving message to DB for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:23:39,681 - INFO - Generated unique_id_with_template: uid_f421e184c90e4c1394ee2c212c405f2e_48f60a86830d6af8_1749986619681
2025-06-15 11:23:39,681 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:23:39,682 - INFO - Processing query for user_id 2: hi
2025-06-15 11:23:39,682 - INFO - Generated unique_id_with_template: uid_f421e184c90e4c1394ee2c212c405f2e_48f60a86830d6af8_1749986619681
2025-06-15 11:23:40,072 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:40,138 - INFO - Intent classification: chat
2025-06-15 11:23:40,138 - INFO - Final prompt created with unique_id_with_template: uid_f421e184c90e4c1394ee2c212c405f2e_48f60a86830d6af8_1749986619681
2025-06-15 11:23:41,025 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:45,098 - INFO - chat_id_enc a4682afb-2dbc-4048-b74c-5ab9e839d38f
2025-06-15 11:23:45,098 - INFO - Executing chat history query for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:23:45,099 - INFO - Saving message to DB for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:23:45,102 - INFO - Generated unique_id_with_template: uid_46f5f5e7d829495a8de2c268d046a191_684751816d89ceda_1749986625102
2025-06-15 11:23:45,103 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:23:45,104 - INFO - Processing query for user_id 2: How many tasks were synced in the last 24 hours?
2025-06-15 11:23:45,104 - INFO - Generated unique_id_with_template: uid_46f5f5e7d829495a8de2c268d046a191_684751816d89ceda_1749986625102
2025-06-15 11:23:45,626 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:45,658 - INFO - Intent classification: sql
2025-06-15 11:23:45,668 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\",\"token_\t2025-06-15 11:23:22\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:23:46,153 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:23:46,495 - INFO - Generated SQL Query for user_id 2:
SELECT COUNT(*) AS synced_tasks_count
FROM tasks
WHERE last_synced_at >= NOW() - INTERVAL 1 DAY
  AND owner_id = 2;
2025-06-15 11:23:46,496 - INFO - Raw DB data retrieved: 1 rows
2025-06-15 11:23:46,496 - INFO - Sample data: {'synced_tasks_count': 50}
2025-06-15 11:23:46,496 - INFO - Final prompt created with unique_id_with_template: uid_46f5f5e7d829495a8de2c268d046a191_684751816d89ceda_1749986625102
2025-06-15 11:23:46,900 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:03,575 - INFO - chat_id_enc a4682afb-2dbc-4048-b74c-5ab9e839d38f
2025-06-15 11:24:03,575 - INFO - Executing chat history query for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:24:03,577 - INFO - Saving message to DB for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:24:03,584 - INFO - Generated unique_id_with_template: uid_41b63eb923b54e4db94aa972c720b721_2a4208182792edb5_1749986643583
2025-06-15 11:24:03,584 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:24:03,584 - INFO - Processing query for user_id 2: Which project has the most deleted tasks?
2025-06-15 11:24:03,585 - INFO - Generated unique_id_with_template: uid_41b63eb923b54e4db94aa972c720b721_2a4208182792edb5_1749986643583
2025-06-15 11:24:04,007 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:04,052 - INFO - Intent classification: sql
2025-06-15 11:24:04,061 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\",\"token_\t2025-06-15 11:23:22\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:24:04,406 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:05,207 - INFO - Generated SQL Query for user_id 2:
SELECT p.name AS project_name,
       COUNT(t.id) AS deleted_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
AND p.owner_id = 2
WHERE t.is_deleted = 1
  AND t.owner_id = 2
GROUP BY p.name
ORDER BY deleted_task_count DESC
LIMIT 1
2025-06-15 11:24:05,208 - INFO - Raw DB data retrieved: 0 rows
2025-06-15 11:24:05,208 - WARNING - No data returned from SQL query
2025-06-15 11:24:05,209 - INFO - Final prompt created with unique_id_with_template: uid_41b63eb923b54e4db94aa972c720b721_2a4208182792edb5_1749986643583
2025-06-15 11:24:05,629 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:49,785 - INFO - chat_id_enc a4682afb-2dbc-4048-b74c-5ab9e839d38f
2025-06-15 11:24:49,785 - INFO - Executing chat history query for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f:

        SELECT sender_type, message
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 11:24:49,787 - INFO - Saving message to DB for chat_id a4682afb-2dbc-4048-b74c-5ab9e839d38f, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 11:24:49,792 - INFO - Generated unique_id_with_template: uid_f9dd14fc804a4afeb7edca051042a5e9_25934ac1428e2469_1749986689791
2025-06-15 11:24:49,792 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 11:24:49,793 - INFO - Processing query for user_id 2: Which tasks are overdue and not in 'completed' status?
2025-06-15 11:24:49,793 - INFO - Generated unique_id_with_template: uid_f9dd14fc804a4afeb7edca051042a5e9_25934ac1428e2469_1749986689791
2025-06-15 11:24:50,173 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:50,211 - INFO - Intent classification: sql
2025-06-15 11:24:50,222 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_9b436561f506b825e74acaafcbe17c375a3a5ddf2b25ff72f4ea0388c249ea8c\",\"token_\t2025-06-15 11:23:22\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_0900_ai_ci\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-15 11:24:50,609 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:24:51,674 - INFO - Generated SQL Query for user_id 2:
SELECT tasks.id,
       tasks.title,
       tasks.due_date,
       tasks.status,
       platform_users.full_name AS user_name,
       projects.name AS project_name
FROM tasks
LEFT JOIN platform_users ON tasks.user_id = platform_users.user_id
AND tasks.owner_id = platform_users.owner_id
LEFT JOIN projects ON tasks.project_id = projects.id
AND tasks.owner_id = projects.owner_id
WHERE tasks.due_date < CURRENT_DATE
  AND tasks.status != 'Done'
  AND tasks.owner_id = 2;
2025-06-15 11:24:51,677 - INFO - Raw DB data retrieved: 48 rows
2025-06-15 11:24:51,678 - INFO - Sample data: {'id': 50, 'title': 'Linear API Integration', 'due_date': '2025-06-09 00:00:00', 'status': 'In Progress', 'user_name': 'allphonesblog ng', 'project_name': None}
2025-06-15 11:24:51,679 - INFO - Final prompt created with unique_id_with_template: uid_f9dd14fc804a4afeb7edca051042a5e9_25934ac1428e2469_1749986689791
2025-06-15 11:24:52,255 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 11:25:41,243 - INFO - Client disconnected from WebSocket
2025-06-15 11:25:57,561 - INFO - Client disconnected from WebSocket
2025-06-15 13:33:41,582 - INFO - Client disconnected from WebSocket
2025-06-15 13:34:09,905 - INFO - chat_id_enc 
2025-06-15 13:34:10,361 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 13:34:11,550 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 13:34:11,807 - INFO - Created new chat with ID 9 and UUID 9ead7df2-a858-4d42-8fac-5ba7c61b9f15 for user 2
2025-06-15 13:34:11,807 - INFO - 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 13:34:11,808 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 13:34:11,810 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 13:34:11,817 - INFO - Generated unique_id_with_template: uid_50ab02834bbc4db8b771edb249220b89_80776e57ffe8c61c_1749994451817
2025-06-15 13:34:11,817 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 13:34:11,818 - INFO - Processing query for user_id 2: hi
2025-06-15 13:34:11,818 - INFO - Generated unique_id_with_template: uid_50ab02834bbc4db8b771edb249220b89_80776e57ffe8c61c_1749994451817
2025-06-15 13:34:12,340 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 13:34:12,373 - INFO - Intent classification: chat
2025-06-15 13:34:12,373 - INFO - Final prompt created with unique_id_with_template: uid_50ab02834bbc4db8b771edb249220b89_80776e57ffe8c61c_1749994451817
2025-06-15 13:34:13,281 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:31:07,921 - INFO - Client disconnected from WebSocket
2025-06-15 14:31:11,822 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:31:11,822 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:31:11,823 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:31:11,829 - INFO - Generated unique_id_with_template: uid_ace729d5197f49f1bfa348473836fdbe_9d7210d8b2da7202_1749997871829
2025-06-15 14:31:11,830 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:31:11,831 - INFO - Processing query for user_id 2: nice
2025-06-15 14:31:11,832 - INFO - Generated unique_id_with_template: uid_ace729d5197f49f1bfa348473836fdbe_9d7210d8b2da7202_1749997871829
2025-06-15 14:31:12,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:31:12,408 - INFO - Intent classification: chat
2025-06-15 14:31:12,408 - INFO - Final prompt created with unique_id_with_template: uid_ace729d5197f49f1bfa348473836fdbe_9d7210d8b2da7202_1749997871829
2025-06-15 14:31:12,984 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:32:22,073 - INFO - Client disconnected from WebSocket
2025-06-15 14:32:34,949 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:32:34,949 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:32:34,950 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:32:34,955 - INFO - Generated unique_id_with_template: uid_e4fcb7e5270e43a7a66da3d14fe74cd6_864a454dc2bd5917_1749997954955
2025-06-15 14:32:34,955 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:32:34,956 - INFO - Processing query for user_id 2: nice
2025-06-15 14:32:34,956 - INFO - Generated unique_id_with_template: uid_e4fcb7e5270e43a7a66da3d14fe74cd6_864a454dc2bd5917_1749997954955
2025-06-15 14:32:36,261 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:32:36,298 - INFO - Intent classification: chat
2025-06-15 14:32:36,299 - INFO - Final prompt created with unique_id_with_template: uid_e4fcb7e5270e43a7a66da3d14fe74cd6_864a454dc2bd5917_1749997954955
2025-06-15 14:32:36,993 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:33:49,204 - INFO - Client disconnected from WebSocket
2025-06-15 14:33:52,466 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:33:52,466 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:33:52,467 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:33:52,471 - INFO - Generated unique_id_with_template: uid_cc40fbccc83f4e129b799046d81d7999_987fe51fdfd2f737_1749998032471
2025-06-15 14:33:52,472 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:33:52,472 - INFO - Processing query for user_id 2: sfsdf
2025-06-15 14:33:52,473 - INFO - Generated unique_id_with_template: uid_cc40fbccc83f4e129b799046d81d7999_987fe51fdfd2f737_1749998032471
2025-06-15 14:33:53,049 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:33:53,068 - INFO - Intent classification: chat
2025-06-15 14:33:53,068 - INFO - Final prompt created with unique_id_with_template: uid_cc40fbccc83f4e129b799046d81d7999_987fe51fdfd2f737_1749998032471
2025-06-15 14:33:53,699 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:36:36,627 - INFO - Client disconnected from WebSocket
2025-06-15 14:36:40,998 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:36:40,998 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:36:41,000 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:36:41,005 - INFO - Generated unique_id_with_template: uid_b9488327f2aa4f29be453fb4982d1f66_055cda4ecfa98784_1749998201005
2025-06-15 14:36:41,005 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:36:41,006 - INFO - Processing query for user_id 2: jdj
2025-06-15 14:36:41,006 - INFO - Generated unique_id_with_template: uid_b9488327f2aa4f29be453fb4982d1f66_055cda4ecfa98784_1749998201005
2025-06-15 14:36:41,398 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:36:41,425 - INFO - Intent classification: chat
2025-06-15 14:36:41,425 - INFO - Final prompt created with unique_id_with_template: uid_b9488327f2aa4f29be453fb4982d1f66_055cda4ecfa98784_1749998201005
2025-06-15 14:36:41,919 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:37:10,528 - INFO - Client disconnected from WebSocket
2025-06-15 14:37:12,563 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:37:12,564 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:37:12,565 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:37:12,569 - INFO - Generated unique_id_with_template: uid_f6cae91606d648d0ae41cc0f8cbe0f9f_553b7efbd9615436_1749998232569
2025-06-15 14:37:12,569 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:37:12,570 - INFO - Processing query for user_id 2: sdf
2025-06-15 14:37:12,570 - INFO - Generated unique_id_with_template: uid_f6cae91606d648d0ae41cc0f8cbe0f9f_553b7efbd9615436_1749998232569
2025-06-15 14:37:13,324 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:37:13,379 - INFO - Intent classification: chat
2025-06-15 14:37:13,379 - INFO - Final prompt created with unique_id_with_template: uid_f6cae91606d648d0ae41cc0f8cbe0f9f_553b7efbd9615436_1749998232569
2025-06-15 14:37:13,809 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:37:15,153 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:37:15,154 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:37:15,155 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:37:15,158 - INFO - Generated unique_id_with_template: uid_6a3fc3d5923f4526834ac219a5c3f460_991d317ae0f3e4fe_1749998235158
2025-06-15 14:37:15,159 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:37:15,159 - INFO - Processing query for user_id 2: sdfsd
2025-06-15 14:37:15,160 - INFO - Generated unique_id_with_template: uid_6a3fc3d5923f4526834ac219a5c3f460_991d317ae0f3e4fe_1749998235158
2025-06-15 14:37:16,162 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:37:16,188 - INFO - Intent classification: chat
2025-06-15 14:37:16,188 - INFO - Final prompt created with unique_id_with_template: uid_6a3fc3d5923f4526834ac219a5c3f460_991d317ae0f3e4fe_1749998235158
2025-06-15 14:37:16,598 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:38:11,622 - INFO - Client disconnected from WebSocket
2025-06-15 14:38:16,246 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 14:38:16,247 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 14:38:16,248 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 14:38:16,253 - INFO - Generated unique_id_with_template: uid_13eac5576f0f4ce1975850d1311e59b4_12dc1b0372ff8acf_1749998296253
2025-06-15 14:38:16,254 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 14:38:16,254 - INFO - Processing query for user_id 2: testing
2025-06-15 14:38:16,255 - INFO - Generated unique_id_with_template: uid_13eac5576f0f4ce1975850d1311e59b4_12dc1b0372ff8acf_1749998296253
2025-06-15 14:38:16,736 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:38:16,796 - INFO - Intent classification: chat
2025-06-15 14:38:16,797 - INFO - Final prompt created with unique_id_with_template: uid_13eac5576f0f4ce1975850d1311e59b4_12dc1b0372ff8acf_1749998296253
2025-06-15 14:38:17,208 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 14:40:41,160 - INFO - Client disconnected from WebSocket
2025-06-15 14:41:10,659 - INFO - Client disconnected from WebSocket
2025-06-15 14:47:18,151 - INFO - Client disconnected from WebSocket
2025-06-15 14:48:00,699 - INFO - Client disconnected from WebSocket
2025-06-15 14:54:37,612 - INFO - Client disconnected from WebSocket
2025-06-15 15:08:48,351 - INFO - Client disconnected from WebSocket
2025-06-15 15:09:06,196 - INFO - chat_id_enc 9ead7df2-a858-4d42-8fac-5ba7c61b9f15
2025-06-15 15:09:06,196 - INFO - Executing chat history query for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-15 15:09:06,198 - INFO - Saving message to DB for chat_id 9ead7df2-a858-4d42-8fac-5ba7c61b9f15, user_id 2:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-15 15:09:06,206 - INFO - Generated unique_id_with_template: uid_623f0b8fb2024d7bb61552124a79926d_e8d91b386e271cf3_1750000146206
2025-06-15 15:09:06,206 - INFO - Fetching workspace types for owner_id 2:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-15 15:09:06,207 - INFO - Processing query for user_id 2: cool
2025-06-15 15:09:06,207 - INFO - Generated unique_id_with_template: uid_623f0b8fb2024d7bb61552124a79926d_e8d91b386e271cf3_1750000146206
2025-06-15 15:09:06,806 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 15:09:06,834 - INFO - Intent classification: chat
2025-06-15 15:09:06,835 - INFO - Final prompt created with unique_id_with_template: uid_623f0b8fb2024d7bb61552124a79926d_e8d91b386e271cf3_1750000146206
2025-06-15 15:09:07,522 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-15 15:14:45,024 - INFO - Client disconnected from WebSocket
2025-06-15 15:29:56,809 - INFO - Client disconnected from WebSocket
2025-06-15 15:31:01,229 - INFO - Client disconnected from WebSocket
2025-06-15 15:32:15,948 - INFO - Client disconnected from WebSocket
2025-06-15 15:33:38,834 - INFO - Client disconnected from WebSocket
2025-06-15 15:35:23,323 - INFO - Client disconnected from WebSocket
2025-06-15 15:36:28,580 - INFO - Client disconnected from WebSocket
2025-06-15 15:36:38,259 - INFO - Client disconnected from WebSocket
2025-06-15 15:38:21,224 - INFO - Client disconnected from WebSocket
2025-06-15 15:40:11,830 - INFO - Client disconnected from WebSocket
2025-06-15 15:40:26,530 - INFO - Client disconnected from WebSocket
2025-06-15 15:44:35,150 - INFO - Client disconnected from WebSocket
2025-06-15 15:44:46,192 - INFO - Client disconnected from WebSocket
2025-06-15 15:45:14,100 - INFO - Client disconnected from WebSocket
2025-06-15 15:47:15,707 - INFO - Client disconnected from WebSocket
2025-06-15 15:48:16,782 - INFO - Client disconnected from WebSocket
2025-06-15 15:49:04,150 - INFO - Client disconnected from WebSocket
2025-06-15 15:49:14,259 - INFO - Client disconnected from WebSocket
2025-06-15 15:49:42,420 - INFO - Client disconnected from WebSocket
2025-06-15 15:51:38,963 - INFO - Client disconnected from WebSocket
2025-06-15 15:52:13,819 - INFO - Client disconnected from WebSocket
2025-06-15 15:52:29,623 - INFO - Client disconnected from WebSocket
2025-06-15 15:52:49,861 - INFO - Client disconnected from WebSocket
2025-06-15 15:55:22,903 - INFO - Client disconnected from WebSocket
2025-06-15 15:56:51,377 - INFO - Client disconnected from WebSocket
2025-06-15 15:57:22,088 - INFO - Client disconnected from WebSocket
2025-06-15 16:02:39,481 - INFO - Client disconnected from WebSocket
2025-06-16 16:02:17,837 - INFO - chat_id_enc 
2025-06-16 16:02:18,084 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:02:18,471 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:02:18,704 - INFO - Created new chat with ID 10 and UUID 18298428-89fe-4236-b69a-28a1bd20fb3d for user 1
2025-06-16 16:02:18,705 - INFO - 18298428-89fe-4236-b69a-28a1bd20fb3d
2025-06-16 16:02:18,706 - INFO - Executing chat history query for chat_id 18298428-89fe-4236-b69a-28a1bd20fb3d:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:02:18,708 - INFO - Saving message to DB for chat_id 18298428-89fe-4236-b69a-28a1bd20fb3d, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:02:18,726 - INFO - Generated unique_id_with_template: uid_4371df1307784aeab5927f676fa7fa86_11de07a9c8a53da0_1750089738726
2025-06-16 16:02:18,727 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:02:18,728 - INFO - Processing query for user_id 1: hi
2025-06-16 16:02:18,729 - INFO - Generated unique_id_with_template: uid_4371df1307784aeab5927f676fa7fa86_11de07a9c8a53da0_1750089738726
2025-06-16 16:02:19,191 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:02:19,227 - INFO - Intent classification: chat
2025-06-16 16:02:19,227 - INFO - Final prompt created with unique_id_with_template: uid_4371df1307784aeab5927f676fa7fa86_11de07a9c8a53da0_1750089738726
2025-06-16 16:02:20,220 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:14:20,098 - INFO - Client disconnected from WebSocket
2025-06-16 16:14:45,834 - INFO - Client disconnected from WebSocket
2025-06-16 16:15:24,371 - INFO - chat_id_enc 
2025-06-16 16:15:24,793 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:25,201 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:25,307 - INFO - Created new chat with ID 11 and UUID a474a5da-5933-43cc-88d8-e71fbefa89e5 for user 1
2025-06-16 16:15:25,307 - INFO - a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:15:25,308 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:15:25,309 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:15:25,312 - INFO - Generated unique_id_with_template: uid_002b77023a8249e3b12eb967937342ba_3e8a69997953eb0c_1750090525312
2025-06-16 16:15:25,312 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:15:25,313 - INFO - Processing query for user_id 1: How many tasks per project are marked high priority?
2025-06-16 16:15:25,314 - INFO - Generated unique_id_with_template: uid_002b77023a8249e3b12eb967937342ba_3e8a69997953eb0c_1750090525312
2025-06-16 16:15:25,835 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:25,884 - INFO - Intent classification: sql
2025-06-16 16:15:25,899 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:15:26,717 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:27,892 - INFO - Generated SQL Query for user_id 1:
SELECT p.name AS project_name,
       COUNT(t.id) AS high_priority_task_count
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
WHERE t.priority = 1
  AND t.owner_id = 1
GROUP BY p.name
2025-06-16 16:15:27,893 - INFO - Raw DB data retrieved: 1 rows
2025-06-16 16:15:27,893 - INFO - Sample data: {'project_name': None, 'high_priority_task_count': 2}
2025-06-16 16:15:27,894 - INFO - Final prompt created with unique_id_with_template: uid_002b77023a8249e3b12eb967937342ba_3e8a69997953eb0c_1750090525312
2025-06-16 16:15:28,429 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:59,228 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:15:59,229 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:15:59,230 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:15:59,235 - INFO - Generated unique_id_with_template: uid_f16a26d022d9481abbc27335d6647134_57836e29cf335752_1750090559235
2025-06-16 16:15:59,235 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:15:59,235 - INFO - Processing query for user_id 1: What percentage of tasks are currently in 'in-progress' status?
2025-06-16 16:15:59,235 - INFO - Generated unique_id_with_template: uid_f16a26d022d9481abbc27335d6647134_57836e29cf335752_1750090559235
2025-06-16 16:15:59,652 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:15:59,686 - INFO - Intent classification: sql
2025-06-16 16:15:59,699 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:16:00,077 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:16:00,927 - INFO - Generated SQL Query for user_id 1:
SELECT (COUNT(*) /
          (SELECT COUNT(*)
           FROM tasks
           WHERE owner_id = 1) * 100) AS in_progress_percentage
FROM tasks
WHERE status = 'In Progress'
  AND owner_id = 1;
2025-06-16 16:16:00,929 - INFO - Raw DB data retrieved: 1 rows
2025-06-16 16:16:00,929 - INFO - Sample data: {'in_progress_percentage': Decimal('30.6122')}
2025-06-16 16:16:00,930 - INFO - Final prompt created with unique_id_with_template: uid_f16a26d022d9481abbc27335d6647134_57836e29cf335752_1750090559235
2025-06-16 16:16:01,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:16:22,601 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:16:22,601 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:16:22,602 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:16:22,609 - INFO - Generated unique_id_with_template: uid_a752170f335a42dd9f6b1b6804ed2a45_f2a9df11b1e07292_1750090582609
2025-06-16 16:16:22,609 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:16:22,611 - INFO - Processing query for user_id 1: which task they are
2025-06-16 16:16:22,611 - INFO - Generated unique_id_with_template: uid_a752170f335a42dd9f6b1b6804ed2a45_f2a9df11b1e07292_1750090582609
2025-06-16 16:16:23,028 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:16:23,069 - INFO - Intent classification: sql
2025-06-16 16:16:23,081 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:16:23,902 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:16:29,278 - INFO - Generated SQL Query for user_id 1:
SELECT tasks.id,
       tasks.title,
       tasks.description,
       tasks.status,
       platform_users.full_name AS user_name,
       projects.name AS project_name
FROM tasks
LEFT JOIN platform_users ON tasks.user_id = platform_users.user_id
AND tasks.owner_id = platform_users.owner_id
LEFT JOIN projects ON tasks.project_id = projects.id
AND tasks.owner_id = projects.owner_id
WHERE tasks.status = 'In Progress'
  AND tasks.owner_id = 1
2025-06-16 16:16:29,280 - INFO - Raw DB data retrieved: 15 rows
2025-06-16 16:16:29,281 - INFO - Sample data: {'id': 1, 'title': 'Linear API Integration', 'description': None, 'status': 'In Progress', 'user_name': 'allphonesblog ng', 'project_name': None}
2025-06-16 16:16:29,281 - INFO - Final prompt created with unique_id_with_template: uid_a752170f335a42dd9f6b1b6804ed2a45_f2a9df11b1e07292_1750090582609
2025-06-16 16:16:29,846 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:14,922 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:17:14,923 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:17:14,925 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:17:14,931 - INFO - Generated unique_id_with_template: uid_e931dcc8f5a9449889a3eb219010a6e9_53fa55bb7acee5f1_1750090634931
2025-06-16 16:17:14,932 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:17:14,932 - INFO - Processing query for user_id 1: How many tasks are missing due dates?
2025-06-16 16:17:14,933 - INFO - Generated unique_id_with_template: uid_e931dcc8f5a9449889a3eb219010a6e9_53fa55bb7acee5f1_1750090634931
2025-06-16 16:17:15,441 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:15,466 - INFO - Intent classification: sql
2025-06-16 16:17:15,477 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:17:16,261 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:16,764 - INFO - Generated SQL Query for user_id 1:
SELECT COUNT(*) AS missing_due_dates
FROM tasks
WHERE due_date IS NULL
  AND owner_id = 1;
2025-06-16 16:17:16,766 - INFO - Raw DB data retrieved: 1 rows
2025-06-16 16:17:16,766 - INFO - Sample data: {'missing_due_dates': 37}
2025-06-16 16:17:16,766 - INFO - Final prompt created with unique_id_with_template: uid_e931dcc8f5a9449889a3eb219010a6e9_53fa55bb7acee5f1_1750090634931
2025-06-16 16:17:17,299 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:30,276 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:17:30,279 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:17:30,281 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:17:30,288 - INFO - Generated unique_id_with_template: uid_30f5f3a04ea54921baffb0e586588b7c_a9afecb722ea9207_1750090650288
2025-06-16 16:17:30,289 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:17:30,291 - INFO - Processing query for user_id 1: give a good breakdown
2025-06-16 16:17:30,292 - INFO - Generated unique_id_with_template: uid_30f5f3a04ea54921baffb0e586588b7c_a9afecb722ea9207_1750090650288
2025-06-16 16:17:30,771 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:30,824 - INFO - Intent classification: sql
2025-06-16 16:17:30,838 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:17:31,452 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:33,134 - INFO - Generated SQL Query for user_id 1:
SELECT t.id AS task_id,
       t.title AS task_title,
       t.status AS task_status,
       t.due_date AS task_due_date,
       pu.full_name AS user_name,
       p.name AS project_name
FROM tasks t
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
AND t.owner_id = pu.owner_id
LEFT JOIN projects p ON t.project_id = p.id
AND t.owner_id = p.owner_id
WHERE t.due_date IS NULL
  AND t.owner_id = 1;
2025-06-16 16:17:33,136 - INFO - Raw DB data retrieved: 37 rows
2025-06-16 16:17:33,136 - INFO - Sample data: {'task_id': 2, 'task_title': 'nice', 'task_status': 'Backlog', 'task_due_date': None, 'user_name': None, 'project_name': None}
2025-06-16 16:17:33,137 - INFO - Final prompt created with unique_id_with_template: uid_30f5f3a04ea54921baffb0e586588b7c_a9afecb722ea9207_1750090650288
2025-06-16 16:17:33,621 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:17:57,598 - ERROR - Streaming error: 
2025-06-16 16:18:06,394 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:18:06,394 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:18:06,396 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:18:06,400 - INFO - Generated unique_id_with_template: uid_1fe8f1389da84732bb4333d13013a44a_e3f7f324aac65047_1750090686400
2025-06-16 16:18:06,400 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:18:06,401 - INFO - Processing query for user_id 1: whats allphonesblog ng perfrormance 
2025-06-16 16:18:06,401 - INFO - Generated unique_id_with_template: uid_1fe8f1389da84732bb4333d13013a44a_e3f7f324aac65047_1750090686400
2025-06-16 16:18:06,917 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:18:06,993 - INFO - Intent classification: sql
2025-06-16 16:18:07,003 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:18:07,528 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:18:08,605 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name AS user_name,
       t.title AS task_title,
       t.status AS task_status,
       t.due_date AS task_due_date
FROM tasks t
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
WHERE pu.name LIKE 'allphonesblog ng'
  AND t.owner_id = 1
2025-06-16 16:18:08,629 - INFO - Raw DB data retrieved: 120 rows
2025-06-16 16:18:08,629 - INFO - Sample data: {'user_name': 'allphonesblog ng', 'task_title': 'Linear API Integration', 'task_status': 'In Progress', 'task_due_date': '2025-06-09 00:00:00'}
2025-06-16 16:18:08,630 - INFO - Final prompt created with unique_id_with_template: uid_1fe8f1389da84732bb4333d13013a44a_e3f7f324aac65047_1750090686400
2025-06-16 16:18:09,355 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:18:56,605 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:18:56,606 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:18:56,607 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:18:56,612 - INFO - Generated unique_id_with_template: uid_f7032d2c0ded4b699332d15545a2a0be_413bf022a1b68704_1750090736612
2025-06-16 16:18:56,612 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:18:56,613 - INFO - Processing query for user_id 1: give break down of ayo and allphonesblog ng tasks for me 
2025-06-16 16:18:56,613 - INFO - Generated unique_id_with_template: uid_f7032d2c0ded4b699332d15545a2a0be_413bf022a1b68704_1750090736612
2025-06-16 16:18:57,109 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:18:57,160 - INFO - Intent classification: sql
2025-06-16 16:18:57,172 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:18:58,599 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:19:01,031 - INFO - Generated SQL Query for user_id 1:
SELECT pu.name AS user_name,
       t.title AS task_title,
       t.status AS task_status,
       t.due_date AS task_due_date,
       p.name AS project_name
FROM tasks t
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
AND t.owner_id = pu.owner_id
LEFT JOIN projects p ON t.project_id = p.id
AND t.owner_id = p.owner_id
WHERE pu.name LIKE '%ayo%'
  OR pu.name LIKE '%allphonesblog ng%'
  AND t.owner_id = 1;
2025-06-16 16:19:01,033 - INFO - Raw DB data retrieved: 36 rows
2025-06-16 16:19:01,033 - INFO - Sample data: {'user_name': 'allphonesblog ng', 'task_title': 'Linear API Integration', 'task_status': 'In Progress', 'task_due_date': '2025-06-09 00:00:00', 'project_name': None}
2025-06-16 16:19:01,034 - INFO - Final prompt created with unique_id_with_template: uid_f7032d2c0ded4b699332d15545a2a0be_413bf022a1b68704_1750090736612
2025-06-16 16:19:01,700 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:19:23,278 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:19:23,278 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:19:23,279 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:19:23,283 - INFO - Generated unique_id_with_template: uid_2d38e2ac54a64a108a2d2816d852268c_f2b791b54cba9579_1750090763283
2025-06-16 16:19:23,284 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:19:23,285 - INFO - Processing query for user_id 1: give chart
2025-06-16 16:19:23,285 - INFO - Generated unique_id_with_template: uid_2d38e2ac54a64a108a2d2816d852268c_f2b791b54cba9579_1750090763283
2025-06-16 16:19:23,674 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:19:23,729 - INFO - Intent classification: sql
2025-06-16 16:19:23,740 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:19:24,237 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:19:25,722 - INFO - Generated SQL Query for user_id 1:
SELECT pu.full_name AS user_name,
       t.status,
       COUNT(t.id) AS task_count
FROM tasks t
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
WHERE t.owner_id = 1
GROUP BY pu.full_name,
         t.status
ORDER BY pu.full_name,
         t.status;
2025-06-16 16:19:25,723 - INFO - Raw DB data retrieved: 10 rows
2025-06-16 16:19:25,724 - INFO - Sample data: {'user_name': None, 'status': 'Backlog', 'task_count': 4}
2025-06-16 16:19:25,724 - INFO - Final prompt created with unique_id_with_template: uid_2d38e2ac54a64a108a2d2816d852268c_f2b791b54cba9579_1750090763283
2025-06-16 16:19:26,846 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:20:08,915 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:20:08,916 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:20:08,918 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:20:08,925 - INFO - Generated unique_id_with_template: uid_053de31eee504310a56b3c81dc0cfeaa_52320dcaa7fb00da_1750090808925
2025-06-16 16:20:08,925 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:20:08,926 - INFO - Processing query for user_id 1: more info
2025-06-16 16:20:08,927 - INFO - Generated unique_id_with_template: uid_053de31eee504310a56b3c81dc0cfeaa_52320dcaa7fb00da_1750090808925
2025-06-16 16:20:09,446 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:20:09,504 - INFO - Intent classification: chat
2025-06-16 16:20:09,504 - INFO - Final prompt created with unique_id_with_template: uid_053de31eee504310a56b3c81dc0cfeaa_52320dcaa7fb00da_1750090808925
2025-06-16 16:20:10,092 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:21:07,842 - INFO - chat_id_enc a474a5da-5933-43cc-88d8-e71fbefa89e5
2025-06-16 16:21:07,843 - INFO - Executing chat history query for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5:

        SELECT sender_type, message, reaction
        FROM chat_messages
        WHERE chat_id = %s
        ORDER BY created_at DESC
        LIMIT 10
    
2025-06-16 16:21:07,844 - INFO - Saving message to DB for chat_id a474a5da-5933-43cc-88d8-e71fbefa89e5, user_id 1:

        INSERT INTO chat_messages (chat_id, user_id, owner_id, sender_type, message)
        VALUES (%s, %s, %s, %s, %s)
    
2025-06-16 16:21:07,848 - INFO - Generated unique_id_with_template: uid_9692dda3474c49f59dab375e1019e77b_5470f0e21831a42d_1750090867848
2025-06-16 16:21:07,849 - INFO - Fetching workspace types for owner_id 1:

        SELECT type
        FROM linked
        WHERE userid = %s
    
2025-06-16 16:21:07,849 - INFO - Processing query for user_id 1: base on allphonesblog ng performance
2025-06-16 16:21:07,850 - INFO - Generated unique_id_with_template: uid_9692dda3474c49f59dab375e1019e77b_5470f0e21831a42d_1750090867848
2025-06-16 16:21:08,346 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:21:08,395 - INFO - Intent classification: sql
2025-06-16 16:21:08,404 - INFO - Database schema: "\nCREATE TABLE linked (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\ttype VARCHAR(100) NOT NULL, \n\tslack_channel VARCHAR(255), \n\ttoken VARCHAR(100) NOT NULL, \n\towner_id INTEGER, \n\tuserid INTEGER NOT NULL, \n\tbot TEXT, \n\tjson TEXT, \n\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from linked table:\nid\ttype\tslack_channel\ttoken\towner_id\tuserid\tbot\tjson\tcreated_at\n1\tlinear\tNone\tlin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\tNone\t1\tNone\t{\"access_token\":\"lin_oauth_7cb02f77570fa56cfaf473489218f276f345c3193bb130983625fa7f9dda7b74\",\"token_\t2025-06-05 14:49:34\n3\tlinear\tNone\tlin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\tNone\t2\tNone\t{\"access_token\":\"lin_oauth_740eee0ff4bf659babba481407b31a1e890e7a2d85bd9ea87f605e0b3bb26fb9\",\"token_\t2025-06-15 11:23:22\n4\tlinear\tNone\tlin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\tNone\t4\tNone\t{\"access_token\":\"lin_oauth_02a5455953ec7f91656029d97c55ee4af928ecaf93625992d4cfba74f9b9b98e\",\"token_\t2025-06-16 15:41:09\n*/\n\n\nCREATE TABLE platform_users (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tname VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci, \n\temail VARCHAR(255), \n\tuser_id VARCHAR(255), \n\tplatform_id INTEGER, \n\tfull_name VARCHAR(255), \n\tsource VARCHAR(50) DEFAULT 'tasks', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from platform_users table:\nid\tname\temail\tuser_id\tplatform_id\tfull_name\tsource\tcreated_at\tupdated_at\towner_id\n1\tprebad50@gmail.com\tprebad50@gmail.com\t0a996c49-4f8f-4af7-9414-01aa7759bb08\t1\tprebad50@gmail.com\tlinear\t2025-06-01 09:02:23\t2025-06-01 09:02:23\t1\n2\tgodswillikwan01@gmail.com\tgodswillikwan01@gmail.com\tb99caeb0-2bb3-4c15-9297-e657a46a3377\t1\tgodswillikwan01@gmail.com\tlinear\t2025-05-11 17:43:54\t2025-05-11 17:43:54\t1\n3\tdev.ayomide@gmail.com\tdev.ayomide@gmail.com\t1d66d358-c981-4563-917f-8e8b35b497e6\t1\tdev.ayomide@gmail.com\tlinear\t2025-03-18 09:45:42\t2025-03-18 09:45:42\t1\n*/\n\n\nCREATE TABLE projects (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tplatform_id VARCHAR(255), \n\tuser_id INTEGER, \n\tname VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstart_date VARCHAR(255), \n\tend_date VARCHAR(255), \n\tproject_key TEXT, \n\tstate VARCHAR(50), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreator VARCHAR(255), \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from projects table:\nid\tplatform_id\tuser_id\tname\tdescription\tstart_date\tend_date\tproject_key\tstate\tsource\tlast_synced_at\tcreator\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tReview\t\t2025-03-20 09:33:45\tNone\t75c36da2-8146-488a-97ae-5557aa8a6ac3\tbacklog\tlinear\t2025-06-05 15:50:07\tc3dd513d-b340-49fe-883e-d780403d978a\t2025-03-20 09:33:45\t2025-03-20 09:33:45\t1\n2\t1\t1\tBackend Dev\t\t2025-03-18 15:01:13\t2025-05-30 00:00:00\td86b31e9-7e50-45d7-a131-ff32a8426511\tstarted\tlinear\t2025-06-05 15:50:07\tae80d1ab-25b0-436a-8f07-cf84b3ddd46a\t2025-03-18 15:01:13\t2025-03-18 15:01:13\t1\n3\t1\t1\tUser Interface\tdesigns\t2025-03-18 09:50:00\tNone\t9ed9fa44-7ff8-4759-a552-4d3de11c1328\tstarted\tlinear\t2025-06-05 15:50:07\t1d66d358-c981-4563-917f-8e8b35b497e6\t2025-03-18 09:50:00\t2025-03-18 09:50:00\t1\n*/\n\n\nCREATE TABLE tasks (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tproject_id VARCHAR(255), \n\tteam_id VARCHAR(255), \n\tplatform_id VARCHAR(255), \n\tparent_id VARCHAR(255), \n\tuser_id VARCHAR(255), \n\ttitle VARCHAR(255) NOT NULL, \n\tdescription TEXT, \n\tstatus VARCHAR(50) NOT NULL, \n\tpriority INTEGER, \n\tlabels JSON, \n\testimate FLOAT, \n\tdue_date VARCHAR(255), \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tis_deleted TINYINT(1) DEFAULT '0', \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from tasks table:\nid\tproject_id\tteam_id\tplatform_id\tparent_id\tuser_id\ttitle\tdescription\tstatus\tpriority\tlabels\testimate\tdue_date\tsource\tlast_synced_at\tis_deleted\tcreated_at\tupdated_at\towner_id\n1\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t48b4aaba-98d1-4ed2-aac3-b954d1373b72\tc3dd513d-b340-49fe-883e-d780403d978a\tLinear API Integration\tNone\tIn Progress\t2\t[{'id': 'aa53bb3f-877e-487d-aebf-67d90da82fad', 'name': 'Feature', 'color': '#BB87FC'}]\t3.3402\t2025-06-09 00:00:00\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-02 23:07:25\t2025-06-02 23:07:25\t1\n2\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\t5d25c827-03d2-4e7c-9bb9-477462f37188\tNone\tnice\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:10\t2025-06-01 08:46:10\t1\n3\tNone\t22bbca10-c482-4700-94c6-bce3956ebb34\t1\td24429c7-cad9-4c33-b04c-5c624cb34091\tNone\tince\tNone\tBacklog\t0\t[]\tNone\tNone\tlinear\t2025-06-05 15:50:07\tNone\t2025-06-01 08:46:07\t2025-06-01 08:46:07\t1\n*/\n\n\nCREATE TABLE teams (\n\tid INTEGER NOT NULL AUTO_INCREMENT, \n\tuser_id INTEGER, \n\tplatform_id VARCHAR(255), \n\tname VARCHAR(255) NOT NULL, \n\tteam_key VARCHAR(50), \n\tdescription TEXT, \n\tsource ENUM('linear','trello','jira') NOT NULL, \n\tlast_synced_at TIMESTAMP NULL, \n\tcreated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP, \n\tupdated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, \n\towner_id INTEGER NOT NULL, \n\tPRIMARY KEY (id)\n)ENGINE=InnoDB COLLATE utf8mb4_0900_ai_ci DEFAULT CHARSET=utf8mb4\n\n/*\n3 rows from teams table:\nid\tuser_id\tplatform_id\tname\tteam_key\tdescription\tsource\tlast_synced_at\tcreated_at\tupdated_at\towner_id\n1\t1\t1\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:50:07\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t1\n2\t1\t1\tOperations\tfabc9d41-eeeb-496e-b6db-c812d7d27cfc\t\tlinear\t2025-06-05 15:50:07\t2025-03-16 22:49:44\t2025-03-16 22:49:44\t1\n3\t2\t2\tEngineering\t22bbca10-c482-4700-94c6-bce3956ebb34\t\tlinear\t2025-06-05 15:51:02\t2025-03-18 14:50:13\t2025-03-18 14:50:13\t2\n*/"
2025-06-16 16:21:09,098 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:21:11,388 - INFO - Generated SQL Query for user_id 1:
SELECT t.title,
       t.status,
       t.due_date,
       t.priority,
       p.name AS project_name,
       pu.full_name AS user_name
FROM tasks t
LEFT JOIN projects p ON t.project_id = p.id
LEFT JOIN platform_users pu ON t.user_id = pu.user_id
WHERE pu.name LIKE '%allphonesblog ng%'
  AND t.owner_id = 1
ORDER BY t.status,
         t.priority;
2025-06-16 16:21:11,391 - INFO - Raw DB data retrieved: 120 rows
2025-06-16 16:21:11,391 - INFO - Sample data: {'title': 'sdfsdf', 'status': 'Backlog', 'due_date': None, 'priority': 0, 'project_name': None, 'user_name': 'allphonesblog ng'}
2025-06-16 16:21:11,392 - INFO - Final prompt created with unique_id_with_template: uid_9692dda3474c49f59dab375e1019e77b_5470f0e21831a42d_1750090867848
2025-06-16 16:21:12,726 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-06-16 16:32:58,693 - INFO - Client disconnected from WebSocket
2025-06-16 16:56:34,193 - INFO - Client disconnected from WebSocket
